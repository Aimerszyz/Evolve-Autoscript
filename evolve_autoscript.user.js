// ==UserScript==
// @name         Evolve_HLXII
// @namespace    http://tampermonkey.net/
// @version      1.2.12
// @description  try to take over the world!
// @author       HLXII
// @match        https://pmotschmann.github.io/Evolve/
// @grant        GM_log
// @require      https://code.jquery.com/jquery-3.3.1.min.js
// @require      https://raw.githubusercontent.com/pieroxy/lz-string/master/libs/lz-string.min.js
// ==/UserScript==
!function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";i.r(t);var n=null,o=null,r=null,l=null,a=null,s=null;function c(){l=document.querySelector("#evo-rna > a"),a=document.querySelector("#evo-dna > a"),n=document.querySelector("#city-food > a"),o=document.querySelector("#city-lumber > a"),r=document.querySelector("#city-stone > a"),s=document.querySelector("#city-slaughter > a")}function u(){null!==n&&n.click(),null!==o&&o.click(),null!==r&&r.click(),null!==l&&l.click(),null!==a&&a.click(),null!==s&&s.click()}var d=null;class p{constructor(e,t){this.id=e,this.loc=t,lt.actions.hasOwnProperty(this.id)||(lt.actions[this.id]={}),lt.actions[this.id].hasOwnProperty("basePriority")||(lt.actions[this.id].basePriority=0),lt.actions[this.id].hasOwnProperty("enabled")||(lt.actions[this.id].enabled=!1)}get enabled(){return lt.actions[this.id].enabled}set enabled(e){lt.actions[this.id].enabled=e}get basePriority(){return lt.actions[this.id].basePriority}set basePriority(e){lt.actions[this.id].basePriority=e}decBasePriority(e){this.basePriority-=e,ct(),console.log("Decrementing Priority",this.id,this.basePriority)}incBasePriority(e){this.basePriority+=e,ct(),console.log("Incrementing Priority",this.id,this.basePriority)}get priority(){return this.basePriority}get label(){return document.querySelector("#"+this.id+" > a > .aTitle")}get btn(){return document.getElementById(this.id)}get unlocked(){return null!==this.label}get name(){let e=this.def.title;return void 0===e?this.id:"string"!=typeof e?e():e}async effect(e){return new Promise(t=>{e.dispatchEvent(new Event("mouseover")),setTimeout((function(){let i=document.querySelector(`#pop${e.id}.popper > div:nth-child(3)`),n=i?i.innerHTML:"";setTimeout((function(){e.dispatchEvent(new Event("mouseout")),t(n)}),25)}),25)})}get def(){let e=window.evolve.actions;for(let t=0;t<this.loc.length;t++)e=e[this.loc[t]];return e}get data(){let e=this.loc[0],t=this.loc[this.loc.length-1];return void 0===window.evolve.global[e]||null==window.evolve.global[e][t]?null:window.evolve.global[e][t]}getResDep(e){if(null===this.btn)return null;let t=this.btn.querySelector(".button");return null===t?null:void 0===(t=t.attributes[`data-${e.toLowerCase()}`])?null:t=+t.value}click(){return null!==this.btn&&(this.btn.className.indexOf("cna")<0&&(this.btn.getElementsByTagName("a")[0].click(),void 0!==this.onBuy&&this.onBuy(),!0))}}class h extends p{constructor(e,t){super(e,t),this.color="has-text-danger"}get researched(){let[e,t]=this.def.grant,i=!1;return void 0!==window.evolve.global.tech[e]&&window.evolve.global.tech[e]>=t&&(i=!0),i}}var m={};function y(e){return m[e].researched}let g=["Deuterium","Neutronium","Adamantite","Infernite","Elerium","Nano_Tube","Graphene","Stanene"];class v{constructor(e){this.id=e,this.color="has-text-info","Money"==e&&(this.color="has-text-success"),g.includes(e)&&(this.color="has-text-advanced"),lt.resources.hasOwnProperty(this.id)||(lt.resources[this.id]={}),lt.resources[this.id].hasOwnProperty("basePriority")||(lt.resources[this.id].basePriority=0),this.crateable&&(lt.resources[this.id].hasOwnProperty("storePriority")||(lt.resources[this.id].storePriority=0),lt.resources[this.id].hasOwnProperty("storeMin")||(lt.resources[this.id].storeMin=0),lt.resources[this.id].hasOwnProperty("storeMax")||(lt.resources[this.id].storeMax=-1)),this.ejectable&&(lt.resources[this.id].hasOwnProperty("eject")||(lt.resources[this.id].eject=!1))}get name(){return window.evolve.global.resource[this.id].name}get unlocked(){return window.evolve.global.resource[this.id].display}get amount(){return window.evolve.global.resource[this.id].amount}get storage(){return window.evolve.global.resource[this.id].max}get ratio(){return this.amount/this.storage}get rate(){return window.evolve.global.resource[this.id].diff}get storePriority(){return lt.resources[this.id].storePriority}set storePriority(e){lt.resources[this.id].storePriority=e}get storeMin(){return lt.resources[this.id].storeMin}set storeMin(e){lt.resources[this.id].storeMin=e}get storeMax(){return lt.resources[this.id].storeMax}set storeMax(e){lt.resources[this.id].storeMax=e}get eject(){return lt.resources[this.id].eject}set eject(e){lt.resources[this.id].eject=e}get ejectable(){return window.evolve.atomic_mass.hasOwnProperty(this.id)}get ejectRate(){return window.evolve.global.interstellar.mass_ejector[this.id]}get ejectMass(){return window.evolve.atomic_mass[this.id].mass/window.evolve.atomic_mass[this.id].size}ejectInc(e){e=void 0===e?1:e;let t=document.querySelector(`#eject${this.id} .trade .add`);if(null===t)return!1;St();for(let i=0;i<e;i++)t.click();return!0}ejectDec(e){e=void 0===e?1:e;let t=document.querySelector(`#eject${this.id} .trade .sub`);if(null===t)return!1;St();for(let i=0;i<e;i++)t.click();return!0}get crateNum(){return window.evolve.global.resource[this.id].crates}get containerNum(){return window.evolve.global.resource[this.id].containers}get crateable(){return window.evolve.global.resource[this.id].stackable}crateInc(e){e=void 0===e?1:e;let t=document.querySelector(`#stack-${this.id} .trade:nth-child(2) .add`);if(null===t)return!1;St();for(let i=0;i<e;i++)t.click();return!0}crateDec(e){e=void 0===e?1:e;let t=document.querySelector(`#stack-${this.id} .trade:nth-child(2) .sub`);if(null===t)return!1;St();for(let i=0;i<e;i++)t.click();return!0}containerInc(e){e=void 0===e?1:e;let t=document.querySelector(`#stack-${this.id} .trade:nth-child(3) .add`);if(null===t)return!1;St();for(let i=0;i<e;i++)t.click();return!0}containerDec(e){e=void 0===e?1:e;let t=document.querySelector(`#stack-${this.id} .trade:nth-child(3) .sub`);if(null===t)return!1;St();for(let i=0;i<e;i++)t.click();return!1}decStorePriority(e){0!=this.storePriority&&(this.storePriority-=e,this.storePriority<0&&(this.storePriority=0),ct(),console.log("Decrementing Store Priority",this.id,this.storePriority))}incStorePriority(e){this.storePriority+=e,ct(),console.log("Incrementing Store Priority",this.id,this.storePriority)}decStoreMin(e){0!=this.storeMin&&(this.storeMin-=e,this.storeMin<0&&(this.storeMin=0),ct(),console.log("Decrementing Store Minimum",this.id,this.storeMin))}incStoreMin(e){this.storeMin+=e,ct(),console.log("Incrementing Store Minimum",this.id,this.storeMin)}decStoreMax(e){-1!=this.storeMax&&(this.storeMax-=e,this.storeMax<-1&&(this.storeMax=-1),ct(),console.log("Decrementing Store Maximum",this.id,this.storeMax))}incStoreMax(e){this.storeMax+=e,ct(),console.log("Incrementing Store Maximum",this.id,this.storeMax)}get basePriority(){return lt.resources[this.id].basePriority}set basePriority(e){lt.resources[this.id].basePriority=e}get priority(){return lt.resources[this.id].basePriority}decBasePriority(e){0!=this.basePriority&&(this.basePriority-=e,this.basePriority<0&&(this.basePrioriity=0),ct(),console.log("Decrementing Base Priority",this.id,this.basePriority))}incBasePriority(e){this.basePriority+=e,ct(),console.log("Incrementing Base Priority",this.id,this.basePriority)}}class f extends v{constructor(e){super(e),lt.resources.hasOwnProperty(this.id)||(lt.resources[this.id]={}),lt.resources[this.id].hasOwnProperty("autoSell")||(lt.resources[this.id].autoSell=!1),lt.resources[this.id].hasOwnProperty("autoBuy")||(lt.resources[this.id].autoBuy=!1),lt.resources[this.id].hasOwnProperty("buyRatio")||(lt.resources[this.id].buyRatio=.5),lt.resources[this.id].hasOwnProperty("sellRatio")||(lt.resources[this.id].sellRatio=.9)}get autoSell(){return lt.resources[this.id].autoSell}set autoSell(e){lt.resources[this.id].autoSell=e}get autoBuy(){return lt.resources[this.id].autoBuy}set autoBuy(e){lt.resources[this.id].autoBuy=e}get buyRatio(){return lt.resources[this.id].buyRatio}set buyRatio(e){lt.resources[this.id].buyRatio=e}get sellRatio(){return lt.resources[this.id].sellRatio}set sellRatio(e){lt.resources[this.id].sellRatio=e}buyDec(e){this.buyRatio>0&&(this.buyRatio=parseFloat(Number(this.buyRatio-.1*e).toFixed(1)),this.buyRatio<0&&(this.buyRatio=0),ct(),console.log(this.id,"Decrementing Buy Ratio",this.buyRatio))}buyInc(e){this.buyRatio<1&&(this.buyRatio=parseFloat(Number(this.buyRatio+.1*e).toFixed(1)),this.buyRatio>1&&(this.buyRatio=0),ct(),console.log(this.id,"Incrementing Buy Ratio",this.buyRatio))}sellDec(e){this.sellRatio>0&&(this.sellRatio=parseFloat(Number(this.sellRatio-.1*e).toFixed(1)),this.sellRatio<0&&(this.sellRatio=0),ct(),console.log(this.id,"Decrementing Sell Ratio",this.sellRatio))}sellInc(e){this.sellRatio<1&&(this.sellRatio=parseFloat(Number(this.sellRatio+.1*e).toFixed(1)),this.sellRatio>1&&(this.sellRatio=1),ct(),console.log(this.id,"Incrementing Sell Ratio",this.sellRatio))}get tradeLabel(){return document.querySelector("#market-"+this.id+" > .trade > .current")}get tradeDecSpan(){return document.querySelector(`#market-${this.id} .trade span:nth-child(4)`)}get tradeIncSpan(){return document.querySelector(`#market-${this.id} .trade span:nth-child(2)`)}get sellBtn(){let e=document.querySelectorAll("#market-"+this.id+" > .order");return null!==e&&e.length>=2?e[1]:null}get buyBtn(){let e=document.querySelectorAll("#market-"+this.id+" > .order");return null!==e&&e.length>=1?e[0]:null}tradeDec(e){e=void 0===e?1:e;let t=document.querySelector(`#market-${this.id} .trade .add`);if(null===t)return!1;St();for(let i=0;i<e;i++)t.click();return!0}tradeInc(e){e=void 0===e?1:e;let t=document.querySelector(`#market-${this.id} .trade .sub`);if(null===t)return!1;St();for(let i=0;i<e;i++)t.click();return!0}get tradeNum(){return window.evolve.global.resource[this.id].trade}get tradeSellCost(){if(null!==this.tradeDecSpan){let t=this.tradeDecSpan.attributes["data-label"].value;var e=/.*([\d\.]+).*\$([\d\.]+)/.exec(t);return parseFloat(e[2])}return console.log("Error:",this.id,"Trade Buy Cost"),-1}get tradeBuyCost(){if(null!==this.tradeIncSpan){let t=this.tradeIncSpan.attributes["data-label"].value;var e=/.*([\d\.]+).*\$([\d\.]+)/.exec(t);return parseFloat(e[2])}return console.log("Error:",this.id,"Trade Sell Cost"),-1}get tradeAmount(){return window.evolve.tradeRatio[this.id]}}var w={};class b extends v{constructor(e){super(e),this.color="has-text-danger",this.sources=window.evolve.craftCost[e],lt.resources.hasOwnProperty(this.id)||(lt.resources[this.id]={}),lt.resources[this.id].hasOwnProperty("enabled")||(lt.resources[this.id].enabled=!1)}get enabled(){return lt.resources[this.id].enabled}set enabled(e){lt.resources[this.id].enabled=e}get craftBtn(){return document.getElementById("inc"+this.id+"5")}get canCraft(){if(this.unlocked&&this.enabled&&this.sources.every((function(e){return w[e.r].ratio>.9}))){let e=1e11;for(let t=0;t<this.sources.length;t++){let i=w[this.sources[t].r],n=5*this.sources[t].a,o=Math.round((i.amount-.9*i.storage)/n);o<e&&(e=o)}return e}return 0}craft(e){if(!this.unlocked||!this.enabled)return!1;if(null===this.craftBtn)return!1;let t=this.craftBtn.children[0],i=Math.min(50,this.canCraft);for(let e=0;e<i;e++)t.click()}}const S={"city-apartment":["electricity"],"city-mill":[],"city-windmill":[],"city-sawmill":["electricity"],"city-rock_quarry":["electricity"],"city-cement_plant":["electricity"],"city-factory":["electricity"],"city-metal_refinery":["electricity"],"city-mine":["electricity"],"city-coal_mine":["electricity"],"city-tourist_center":["Food"],"city-casino":["electricity","Money"],"city-wardenclyffe":["electricity"],"city-biolab":["electricity"],"city-coal_power":["electricity","Coal"],"city-oil_power":["electricity","Oil"],"city-fission_power":["electricity","Uranium"],"city-mass_driver":["electricity"],"space-nav_beacon":["electricity","moon_support","red_support"],"space-moon_base":["moon_support","Oil","electricity"],"space-iridium_mine":["moon_support","Iridium"],"space-helium_mine":["moon_support","Helium_3"],"space-observatory":["moon_support"],"space-spaceport":["red_support","Helium_3","electricity","Food"],"space-red_tower":["red_support","electricity"],"space-living_quarters":["red_support"],"space-vr_center":["red_support"],"space-red_mine":["red_support"],"space-fabrication":["red_support"],"space-red_factory":["electricity","Helium_3"],"space-biodome":["red_support"],"space-exotic_lab":["red_support"],"space-space_barracks":["Oil","Food"],"space-geothermal":["electricity","Helium_3"],"space-swarm_control":["swarm_support"],"space-swarm_satellite":["swarm_support","electricity"],"space-gas_mining":["Helium_3","electricity"],"space-outpost":["Neutronium","Oil","electricity"],"space-oil_extractor":["Oil","electricity"],"space-space_station":["belt_support","Helium_3","Food","electricity"],"space-elerium_ship":["belt_support","Elerium"],"space-iridium_ship":["belt_support","Iridium"],"space-iron_ship":["belt_support","Iron"],"space-elerium_contain":["electricity"],"space-e_reactor":["electricity","Elerium"],"space-world_controller":["electricity"],"interstellar-starport":["alpha_support","Helium_3","electricity","Food"],"interstellar-habitat":["alpha_support","electricity"],"interstellar-mining_droid":["alpha_support"],"interstellar-processing":["alpha_support"],"interstellar-fusion":["alpha_support","electricity","Deuterium"],"interstellar-laboratory":["alpha_support"],"interstellar-exchange":["alpha_support"],"interstellar-g_factory":["alpha_support"],"interstellar-xfer_station":["alpha_support","Uranium","electricity"],"interstellar-cruiser":["Helium_3"],"interstellar-dyson_net":["electricity"],"interstellar-nexus":["nebula_support","electricity","Money"],"interstellar-harvester":["nebula_support","Helium_3","Deuterium"],"interstellar-elerium_prospector":["nebula_support","Elerium"],"interstellar-neutron_miner":["Neutronium","Helium_3","electricity"],"interstellar-far_reach":["electricity"],"interstellar-stellar_engine":["electricity"],"interstellar-mass_ejector":["electricity"],"portal-turret":["electricity"],"portal-war_droid":["electricity"],"portal-war_drone":["electricity"],"portal-sensor_drone":["electricity"],"portal-attractor":["electricity"]};async function P(e){if(!y("tech-electricity"))return;let t=[],i=0,n=[],o=0,r=[],l=[],a={electricity:0,moon_support:0,red_support:0,swarm_support:0,belt_support:0,alpha_support:0,nebula_support:0};for(let e in A){if(!A[e].unlocked)continue;if(!(A[e]instanceof O))continue;if(!A[e].powerUnlocked)continue;if(!(A[e]instanceof O))continue;if([A[e].consume,A[e].produce]=await A[e].getCP(),"interstellar-stellar_engine"==A[e].id){100==A[e].numTotal&&(a.electricity+=A[e].produce[0].cost);continue}if("interstellar-dyson_net"==A[e].id)continue;for(let t=0;t<A[e].consume.length;t++)void 0!==w[A[e].consume[t].res]&&(w[A[e].consume[t].res].temp_rate+=A[e].numOn*A[e].consume[t].cost);for(let t=0;t<A[e].produce.length;t++)void 0!==w[A[e].produce[t].res]&&(w[A[e].produce[t].res].temp_rate-=A[e].numOn*A[e].produce[t].cost*gt(A[e].produce[t].res)*gt("Global"));t.push(A[e]),i+=A[e].numTotal;let r=A[e].powerPriority**5;o+=r,n.push(r),l.push(A[e].numTotal)}for(let e=0;e<t.length;e++)r.push(n[e]/o);let s=ft(i,n,r,{max:l,requireFunc:function(e,i){let n=t[e];for(let e=0;e<n.consume.length;e++){let t=n.consume[e].res,i=n.consume[e].cost;if(void 0!==w[t]){if(w[t].temp_rate<i)return!1}else if(a[t]<i)return!1}return!0},allocFunc:function(e,i){let n=t[e];for(let e=0;e<n.consume.length;e++){let t=n.consume[e].res,i=n.consume[e].cost;void 0!==w[t]?w[t].temp_rate-=i:a[t]-=i}for(let e=0;e<n.produce.length;e++){let t=n.produce[e].res,i=n.produce[e].cost;void 0!==w[t]?w[t].temp_rate+=i*gt(t)*gt("Global"):a[t]+=i}}});console.log("POWERED:",t,"PRIO:",n,"RATIO:",r),console.log("SUPPORT ALLOC:",s),console.log("REMAIN:",a);for(let e=0;e<t.length;e++){let i=t[e];i.numOn<s.alloc[e]?i.incPower(s.alloc[e]-i.numOn):i.decPower(i.numOn-s.alloc[e])}}var k=!1;async function _(e){return 0==$(".modal").length&&(!k&&(k=!0,e.click(),await yt(50),!0))}async function x(){let e=$(".modal-close")[0];void 0!==e&&e.click(),k=!1,await yt(50)}class C extends p{constructor(e,t){super(e,t),lt.actions[this.id].hasOwnProperty("atLeast")||(lt.actions[this.id].atLeast=0),lt.actions[this.id].hasOwnProperty("limit")||(lt.actions[this.id].limit=-1),lt.actions[this.id].hasOwnProperty("softCap")||(lt.actions[this.id].softCap=-1),this.color="has-text-warning"}get atLeast(){return lt.actions[this.id].atLeast}set atLeast(e){lt.actions[this.id].atLeast=e}get limit(){return lt.actions[this.id].limit}set limit(e){lt.actions[this.id].limit=e}get softCap(){return lt.actions[this.id].softCap}set softCap(e){lt.actions[this.id].softCap=e}get priority(){return 0!=this.atLeast&&this.numTotal<this.atLeast?100:this.basePriority}get unlocked(){return null!==this.btn}get numTotal(){return null===this.data?0:this.data.count}decAtLeast(e){0!=this.atLeast&&(this.atLeast-=e,this.atLeast<0&&(this.atLeast=0),ct(),console.log("Decrementing At Least",this.id,this.atLeast))}incAtLeast(e){this.atLeast+=e,ct(),console.log("Incrementing At Least",this.id,this.atLeast)}decLimit(e){-1!=this.limit&&(this.limit-=e,this.limit<-1&&(this.limit=-1),ct(),console.log("Decrementing Limit",this.id,this.limit))}incLimit(e){this.limit+=e,ct(),console.log("Incrementing Limit",this.id,this.limit)}decSoftCap(e){-1!=this.softCap&&(this.softCap-=e,this.softCap<-1&&(this.softCap=1),ct(),console.log("Decrementing SoftCap",this.id,this.softCap))}incSoftCap(e){this.softCap+=e,ct(),console.log("Incrementing SoftCap",this.id,this.softCap)}}class O extends C{constructor(e,t){super(e,t),lt.actions[this.id].hasOwnProperty("powerPriority")||(lt.actions[this.id].powerPriority=0)}get powerPriority(){return lt.actions[this.id].powerPriority}set powerPriority(e){lt.actions[this.id].powerPriority=e}get powerUnlocked(){return e=this.def,t=!0,e.power_reqs&&Object.keys(e.power_reqs).forEach((function(i){window.evolve.global.tech.hasOwnProperty(i)?window.evolve.global.tech[i]<e.power_reqs[i]&&(t=!1):t=!1})),t;var e,t}get incBtn(){return document.querySelector("#"+this.id+" > .on")}get decBtn(){return document.querySelector("#"+this.id+" > .off")}get numOn(){return this.data&&this.data.on?this.data.on:0}async getCP(){let e=[],t=[],i=this.effect,n=await i(this.btn);switch([e,t]=function(e,t){let i=[],n=[];for(let o=0;o<e.length;o++)switch(e[o]){case"Money":{let e=/generates \$([\d\.]+)/.exec(t);if(e){n.push({res:"Money",cost:+e[1]});break}null!==(e=/([+-]?)\$([\d\.]+)\/s/.exec(t))&&("-"==e[1]?i.push({res:"Money",cost:+e[2]}):n.push({res:"Money",cost:+e[2]}));break}case"Food":{let r=window.evolve.global.resource[e[o]].name,l=new RegExp("([+-]?)([\\d\\.]+) "+r).exec(t);l&&("-"==l[1]?i.push({res:"Food",cost:+l[2]}):n.push({res:"Food",cost:+l[2]}));break}case"Iron":{let r=window.evolve.global.resource[e[o]].name,l=new RegExp("([+-]?)([\\d\\.]+) "+r).exec(t);l&&("-"==l[1]?i.push({res:"Iron",cost:+l[2]}):n.push({res:"Iron",cost:+l[2]}));break}case"Coal":{let r=window.evolve.global.resource[e[o]].name,l=new RegExp("([+-]?)([\\d\\.]+) "+r).exec(t);l&&("-"==l[1]?i.push({res:"Coal",cost:+l[2]}):n.push({res:"Coal",cost:+l[2]}));break}case"Oil":{let r=window.evolve.global.resource[e[o]].name,l=new RegExp("([+-]?)([\\d\\.]+) "+r).exec(t);l&&("-"==l[1]?i.push({res:"Oil",cost:+l[2]}):n.push({res:"Oil",cost:+l[2]}));break}case"Uranium":{let r=window.evolve.global.resource[e[o]].name,l=new RegExp("([+-]?)([\\d\\.]+) "+r).exec(t);l&&("-"==l[1]?i.push({res:"Uranium",cost:+l[2]}):n.push({res:"Uranium",cost:+l[2]}));break}case"Iridium":{let r=window.evolve.global.resource[e[o]].name,l=new RegExp("([+-]?)([\\d\\.]+) "+r).exec(t);l&&("-"==l[1]?i.push({res:"Iridium",cost:+l[2]}):n.push({res:"Iridium",cost:+l[2]}));break}case"Helium_3":{let r=window.evolve.global.resource[e[o]].name,l=new RegExp("([+-]?)([\\d\\.]+) "+r).exec(t);l&&("-"==l[1]?i.push({res:"Helium_3",cost:+l[2]}):n.push({res:"Helium_3",cost:+l[2]}));break}case"Deuterium":{let r=window.evolve.global.resource[e[o]].name,l=new RegExp("([+-]?)([\\d\\.]+) "+r).exec(t);l&&("-"==l[1]?i.push({res:"Deuterium",cost:+l[2]}):n.push({res:"Deuterium",cost:+l[2]}));break}case"Neutronium":{let r=window.evolve.global.resource[e[o]].name,l=new RegExp("([+-]?)([\\d\\.]+) "+r).exec(t);l&&("-"==l[1]?i.push({res:"Neutronium",cost:+l[2]}):n.push({res:"Neutronium",cost:+l[2]}));break}case"Elerium":{let r=window.evolve.global.resource[e[o]].name,l=new RegExp("([+-]?)([\\d\\.]+) "+r).exec(t);l&&("-"==l[1]?i.push({res:"Elerium",cost:+l[2]}):n.push({res:"Elerium",cost:+l[2]}));break}case"electricity":{let e=/(Uses|uses|Consumes|consumes) ([\d\.]+)kW/.exec(t);if(e){i.push({res:"electricity",cost:+e[2]});break}(e=/([+-]?)([\d\.]+)kW/.exec(t))&&("-"==e[1]?i.push({res:"electricity",cost:+e[2]}):n.push({res:"electricity",cost:+e[2]}));break}case"moon_support":{let e=/([+-]?)([\d\.]+) Moon/.exec(t);null!==e&&("-"==e[1]?i.push({res:"moon_support",cost:+e[2]}):n.push({res:"moon_support",cost:+e[2]}));break}case"red_support":{let e=window.evolve.global.race.species,o=window.evolve.races[e].solar.red,r=new RegExp("([+-])?([\\d\\.]+) "+o).exec(t);null!==r&&("-"==r[1]?i.push({res:"red_support",cost:+r[2]}):n.push({res:"red_support",cost:+r[2]}));break}case"swarm_support":{let e=/([+-]?)([\d\.]+) Swarm/.exec(t);null!==e&&("-"==e[1]?i.push({res:"swarm_support",cost:+e[2]}):n.push({res:"swarm_support",cost:+e[2]}));break}case"belt_support":{let e=/\+([\d\.]+) Max Space Miner/.exec(t);if(e){n.push({res:"belt_support",cost:+e[1]});break}(e=/Requires ([\d\.]+) Space Miner/.exec(t))&&i.push({res:"belt_support",cost:+e[1]});break}case"alpha_support":{let e=/([+-]?)([\d\.]+) Alpha/.exec(t);e&&("-"==e[1]?i.push({res:"alpha_support",cost:+e[2]}):n.push({res:"alpha_support",cost:+e[2]}));break}case"nebula_support":{let e=/([+-]?)([\d\.]+) (Nebula|Helix Nebula)/.exec(t);e&&("-"==e[1]?i.push({res:"nebula_support",cost:+e[2]}):n.push({res:"nebula_support",cost:+e[2]}));break}}return[i,n]}(S[this.id],n),this.id){case"city-mill":e.push({res:"Food",cost:10}),t.push({res:"electricity",cost:1});break;case"city-tourist_center":break;case"city-windmill":t.push({res:"electricity",cost:1})}return[e,t]}incPower(e){if(e=void 0===e?1:e,null===this.incBtn)return!1;St();for(let t=0;t<e;t++)this.incBtn.click();return!0}decPower(e){if(e=void 0===e?1:e,null===this.decBtn)return!1;for(let t=0;t<e;t++)this.decBtn.click();return!0}decPowerPriority(e){0!=this.powerPriority&&(this.powerPriority-=e,this.powerPriority<0&&(this.powerPriority=0),ct(),console.log("Decrementing Power Priority",this.id,this.powerPriority))}incPowerPriority(e){this.powerPriority+=e,ct(),console.log("Incrementing Priority",this.id,this.powerPriority)}}class M extends C{constructor(e,t){super(e,t),this.res={}}get unlocked(){return A["space-star_dock"].numTotal>0&&("spcdock-seeder"!=this.id||y("tech-genesis_ship"))}get data(){let[e,t]=this.id.split("-");return window.evolve.global.starDock[t]}loadRes(){let e=$("#"+this.id+" > a")[0];for(let t=0;t<e.attributes.length;t++){let i=e.attributes[t].name,n=e.attributes[t].value;i.indexOf("data-")>=0&&(this.res[i.substr(5,i.length)]=parseInt(n))}}getResDep(e){return this.res[e.toLowerCase()]}async click(){if(!this.unlocked)return!1;if(!await _($("#space-star_dock > .special")))return!1;let e=this.id,t=A[e];return null!==t.btn&&t.btn.getElementsByTagName("a")[0].click(),await x(),!0}}var A={};function R(){return window.evolve.global.civic.garrison.max}function I(){return R()-(window.evolve.global.portal.hasOwnProperty("fortress")?window.evolve.global.portal.fortress.assigned:0)}function T(){return window.evolve.global.portal.hasOwnProperty("fortress")?window.evolve.global.civic.garrison.workers-window.evolve.global.portal.fortress.assigned:window.evolve.global.civic.garrison.workers}function B(){return window.evolve.global.civic.garrison.raid}function L(e){e=void 0===e?1:e;let t=document.querySelector("#tactics > .sub");if(null!==t){St();for(let i=0;i<e;i++)t.click()}}function E(e){e=e||1;let t=document.querySelector("#battalion > .add");if(null!==t){St();for(let i=0;i<e;i++)t.click()}}function q(){let e=document.querySelector("#garrison > div:nth-child(4) > div:nth-child(2) > span > button");null!==e&&e.click()}let N=!1,F=0,D=!1,j=0;function W(){if(!y("tech-garrison"))return;if(window.evolve.global.tech.world_control)return;if(lt.campaignFailCheck&&j>0)return void(j-=1);let e=T(),t=I(),i=window.evolve.global.civic.garrison.wounded,n=R()-i;if(e&&e==t?lt.woundedCheck&&i>0||(N=!0):(N=!1,D=!1,F=0),N)switch(F){case 0:L(4),function(e){e=void 0===e?1:e;let t=document.querySelector("#tactics > .add");if(null!==t){St();for(let i=0;i<e;i++)t.click()}}(lt.maxCampaign),E(t),F+=1;break;case 1:(function(){let e=document.querySelector("#garrison > div:nth-child(4) > div:nth-child(2) > span");if(null===e)return 0;e=e.attributes["data-label"].value,e=/([\d\.]+)% ([\w]+)/.exec(e);let[t,i,n]=e;return i=parseFloat(i),i*="advantage"==n?1:-1})()<=lt.minWinRate?D?(E(),B()<=n&&q(),N=!1,D=!1,F=0):0==window.evolve.global.civic.garrison.tactic?(N=!1,D=!1,F=0,lt.campaignFailCheck&&(j=1e3*lt.campaignFailInterval/25)):L():(D=!0,function(e){e=e||1;let t=document.querySelector("#battalion > .sub");if(null!==t){St();for(let i=0;i<e;i++)t.click()}}(),0==B()&&(E(),B()<n&&q(),N=!1,D=!1,F=0));break}}let U=null;class G extends p{constructor(e){super(e,["misc"]),this.color="has-text-advanced"}}class H extends C{constructor(e,t){super(e,["misc"]),this.loc.push("arpa"),this.res=t,this.color="has-text-special"}get label(){return document.querySelector("#arpa"+this.id+" > .head > .desc")}get btn(){return document.querySelector("#arpa"+this.id+" > div.buy > button.button.x25")}get name(){return null===this.label?this.id:this.label.innerText}get unlocked(){return!!window.evolve.global.arpa.hasOwnProperty(this.id)&&("launch_facility"!==this.id||1!==window.evolve.global.arpa[this.id].rank)}get numTotal(){return void 0!==window.evolve.global.arpa[this.id]?window.evolve.global.arpa[this.id].rank:0}getResDep(e){return null===this.res?null:this.res[e]*1.05**this.numTotal/4}click(){return null!==this.btn&&(this.btn.click(),!0)}}class K extends H{constructor(e){super(e,{})}click(){return null!==this.btn&&(this.btn.click(),setTimeout(V,500),!0)}}function V(){if(null!==z.monument.label)switch(z.monument.label.innerText){case"Obelisk":z.monument.res={Stone:1e6};break;case"Statue":z.monument.res={Aluminium:35e4};break;case"Sculpture":z.monument.res={Steel:3e5};break;case"Monolith":z.monument.res={Cement:3e5}}}var z={};class J extends G{constructor(e,t){super(e),this.loc.push("storage"),this.res=t}get countLabel(){return document.querySelector("#cnt"+this.name+"s")}get btn(){let e=document.querySelector("."+this.id.toLowerCase());return null===e?null:e.children[0]}get unlocked(){return"Crate"==this.id?y("tech-containerization"):y("tech-steel_containers")}get name(){return this.id.charAt(0).toUpperCase()+this.id.slice(1)}get full(){if(null!==this.countLabel){let e=this.countLabel.innerText.split(" / ");return parseInt(e[0])==parseInt(e[1])}return console.log("Error:",this.id,"Full"),!0}getResDep(e){return null===this.res?null:this.res[e]}click(){let e=this.btn;if(null===e)return!1;for(let t=0;t<10;t++)e.click();return!0}}var Q={};class Y extends G{constructor(e){super(e),this.res={Knowledge:2e5}}get btn(){let e=$("#arpaSequence > span > button").not(".has-text-success");return e.length?e[0]:null}get unlocked(){return null!==this.btn}get name(){return"Assemble Gene"}getResDep(e){return null===this.res?null:this.res[e]}click(){let e=this.btn;return null!==e&&(e.click(),!0)}}class X extends G{constructor(e){super(e),this.loc.push("mercenary"),this.res={}}get btn(){let e=$("button.first");return e.length?e[0]:null}get unlocked(){return window.evolve.global.civic.garrison.mercs}get name(){return"Hire Garrison Mercenary"}getResDep(e){let t=$(".hire > span")[0].attributes["data-label"].value,i=/[^\d]*([\d]+)[^\d]*/.exec(t);return this.res.Money=i[1],null===this.res?null:this.res[e]}click(){if(T()===I())return!1;let e=this.btn;return null!==e&&(e.click(),!0)}}class Z extends X{constructor(e){super(e)}get btn(){let e=$("button.merc");return e.length?e[0]:null}get name(){return"Hire Fortress Mercenary"}}class ee extends G{constructor(e){super(e),this.res={}}get btn(){let e=$("#city-s_alter > a");return e.length?e[0]:null}get unlocked(){let e=window.evolve.global.city.hasOwnProperty("s_alter")&&1==window.evolve.global.city.s_alter.count,t=!1;for(let e in window.evolve.global.resource)if(Object.keys(window.evolve.races).includes(e)){t=window.evolve.global.resource[e].amount==window.evolve.global.resource[e].max;break}return e&&t}get name(){return"Sacrifice"}getResDep(e){return null}click(){let e=this.btn;return null!==e&&(e.click(),!0)}}var te={};class ie{constructor(e,t){this.id=e,lt.jobs.hasOwnProperty(this.id)||(lt.jobs[this.id]={}),lt.jobs[this.id].hasOwnProperty("priority")||(lt.jobs[this.id].priority=t)}get _priority(){return lt.jobs[this.id].priority}set _priority(e){lt.jobs[this.id].priority=e}get hireBtn(){return document.querySelector("#civ-"+this.id+" > .controls > .add")}get fireBtn(){return document.querySelector("#civ-"+this.id+" > .controls > .sub")}get name(){return window.evolve.global.civic[this.id].name}get employed(){return window.evolve.global.civic[this.id].workers}get maxEmployed(){return window.evolve.global.civic[this.id].max}get priority(){return this._priority}lowerPriority(e){0!=this._priority&&(this._priority-=e,this._priority<0&&(this._priority=0),ct(),console.log("Lowering",this.name,"Priority",this._priority))}higherPriority(e){this._priority+=e,ct(),console.log("Increasing",this.name,"Priority",this._priority)}get unlocked(){return window.evolve.global.civic[this.id].display}hire(e){void 0===e&&(e=1);let t=this.hireBtn;if(null===t)return!1;St();for(let i=0;i<e;i++)t.click();return!0}fire(e){void 0===e&&(e=1);let t=this.fireBtn;if(null===t)return!1;St();for(let i=0;i<e;i++)t.click();return!0}}class ne extends ie{constructor(e,t){super(e,t)}get priority(){return"Hunter"==this.name?this._priority:0}get hireFunc(){return function(){}}get fireFunc(){return function(){}}get name(){return window.evolve.global.race.carnivore||window.evolve.global.race.soul_eater?"Hunter":"Unemployed"}get employed(){return window.evolve.global.civic[this.id]}get maxEmployed(){return-1}get unlocked(){return!0}}class oe extends ie{constructor(e,t){super(e,t)}get hireBtn(){return document.querySelector("#foundry .job:nth-child(2) > .controls > .add")}get fireBtn(){return document.querySelector("#foundry .job:nth-child(2) > .controls > .sub")}}var re={};class le extends ie{constructor(e,t){super(e,t)}get hireBtn(){return document.getElementById("craft"+this.id).parentNode.children[1].children[1]}get fireBtn(){return document.getElementById("craft"+this.id).parentNode.children[1].children[0]}get name(){return window.evolve.global.resource[this.id].name}get unlocked(){return window.evolve.global.resource[this.id].display}get employed(){return window.evolve.global.city.foundry[this.id]}get maxEmployed(){return-1}}var ae={};let se=["tech-club","tech-bone_tools"],ce=["city-lumber_yard","city-rock_quarry","city-cement_plant","city-foundry","city-metal_refinery","city-mine","city-coal_mine","city-amphitheatre","city-university","city-wardenclyffe","tech-investing","tech-reclaimer","space-living_quarters","space-space_station","portal-carport"],ue=["city-garrison","city-storage_yard","city-warehouse","city-cement_plant","city-foundry","city-factory","city-metal_refinery","city-mine","city-coal_mine","city-oil_well","space-iridium_mine","space-helium_mine","space-outpost","interstellar-mining_droid","interstellar-g_factory","interstellar-nexus","portal-carport"];function de(e){se.includes(e.id)&&c(),ce.includes(e.id)&&lt.autoEmploy&&Re(),ue.includes(e.id)&&(lt.autoMarket&&_e(),lt.autoTrade&&Ce(),lt.autoStorage&&Se(),lt.autoEjector&&Me())}let pe="is-primary is-bottom is-small b-tooltip is-animated is-multiline";function he(e,t,i,n){let o=$(`<span role="button" aria-label="Decrease ${t}" class="sub">«</span>`),r=$(`<span id="${t}_control" class="count current" style="width:2rem;">${e}</span>`);o.on("click",(function(e){let n=Pt(e);document.getElementById(t+"_control").innerText=i(n),ct()}));let l=$(`<span role="button" aria-label="Increase ${t}" class="add">»</span>`);return l.on("click",(function(e){let i=Pt(e);document.getElementById(t+"_control").innerText=n(i),ct()})),$(`<div class="controls as-${t}-settings" style="display:flex"></div>`).append(o).append(r).append(l)}function me(e,t,i){i=i||{};let n=Array.isArray(e)?e.join("_"):e,o=void 0!==i.small?'style="height:5px;"':"",r=$(`\n    <label class="switch" id="${n}_toggle">\n    <input type="checkbox" true-value="true" value="false">\n    <span class="check" ${o}></span>\n    <span class="control-label"><span class="is-primary is-bottom is-small is-animated is-multiline">${t}</span>\n    </span>\n    </label>`),l=lt;if(i.hasOwnProperty("path")){l=i.path[0];for(let e=1;e<i.path.length-1;e++)l=l[i.path[e]];e=i.path[i.path.length-1]}return r.children("input").on("click",(function(t){if(1!=t.which)return;let o=t.currentTarget,r=!("true"===o.getAttribute("value"));o.setAttribute("value",r),l[e]=r,console.log(`Setting ${n} to ${r}`),ct(),r&&void 0!==i.enabledCallBack?i.enabledCallBack():void 0!==i.disabledCallBack&&i.disabledCallBack(),void 0!==i.onChange&&i.onChange(r)})),l[e]&&setTimeout((function(){console.log(`Setting ${n} initially to true`),r.children("span.check").click(),r.children("input").attr("value",!0)}),1e3),r}function ye(e,t,i,n,o){o=o||{};let r=$(`<div style="display:flex;" id="${t}_dropdown"></div>`),l=$(`<span class="has-text-warning" style="width:12rem;">${i}:</span>`);void 0!==o.toolTip&&(l.addClass(pe),l.attr("data-label",o.toolTip)),r.append(l);let a=$('<select style="width:12rem;"></select>');for(let e in n)a.append($(`<option value="${e}">${n[e]}</option>`));return a[0].value=lt[t],a[0].onchange=function(){lt[t]=a[0].value,console.log(`Changing ${t} to ${lt[t]}`),ct(),void 0!==o.onChange&&o.onChange(a[0].value)},r.append(a),r}function ge(e,t,i,n){n=n||{};let o=$(`\n    <label class="b-checkbox checkbox" id="${t}">\n    <input type="checkbox" true-value="Yes" false-value="No" value="false">\n    <span class="check is-dark"></span>\n    <span class="control-label">${i}</span>\n    </label>`);void 0!==n.toolTip&&(o.addClass(pe),o.attr("data-label",n.toolTip));let r=lt;if(n.hasOwnProperty("path")){r=n.path[0];for(let e=1;e<n.path.length-1;e++)r=r[n.path[e]];t=n.path[n.path.length-1]}return o.children("input").on("click",(function(e){if(1!=e.which)return;let i=e.currentTarget,o=!("true"===i.getAttribute("value"));i.setAttribute("value",o),r[t]=o,console.log("Setting",t,"to",o),ct(),o&&void 0!==n.enabledCallBack?n.enabledCallBack():void 0!==n.disabledCallBack&&n.disabledCallBack()})),r[t]&&setTimeout((function(){console.log("Setting initially to true"),o.children("span.check").click(),o.children("input").attr("value",!0)}),1e3),o}function ve(e,t,i,n){n=n||{};let o=$(`<div style="display:flex" id="${t}_input"></div>`),r=$(`<span class="has-text-warning" style="width:12rem;">${i}:</span>`);void 0!==n.toolTip&&(r.addClass(pe),r.attr("data-label",n.toolTip)),o.append(r);let l=$('<input type="text" class="input is-small" style="width:10rem;"/>');o.append(l);let a=lt;if(n.hasOwnProperty("path")){a=n.path[0];for(let e=1;e<n.path.length-1;e++)a=a[n.path[e]];t=n.path[n.path.length-1]}l.val(e);let s=$(`<a class="button is-dark is-small" id="${t}_input_set" style="width:2rem;"><span>Set</span></a>`);return o.append(s),s.on("click",(function(e){if(1!=e.which)return;let o=l.val();void 0!==n.convertFunc&&(o=n.convertFunc(o)),null!==o?(console.log(`Setting input ${i} to ${o}`),a[t]=o,l.val(o),ct(),void 0!==n.setFunc&&n.setFunc(a.id)):l.val(a[t])})),o}function fe(){0==$(".as-autolog").length&&function(){let e=$('<div id="autolog" class="msgQueue right resource alt as-autolog"></div>');$("#queueColumn").append(e)}(),0==$("#autoSettingTab").length&&function(){let e=$('<li class="as-settings"><a><span>Auto Settings</span></a></li>'),t=$('<div id="autoSettingTab" class="tab-item as-settings" style="display:none"><h2 class="is-sr-only">Auto Settings</h2></div>');for(let i=1;i<=$("#mainColumn > .content > .b-tabs > .tabs > ul").children().length;i++){let n=$("#mainColumn > .content > .b-tabs > .tabs > ul > li:nth-child("+i+")"),o=$("#mainColumn > .content > .b-tabs > .tab-content").children()[i-1];n.on("click",(function(i){1==i.which&&(e.hasClass("is-active")&&(e.removeClass("is-active"),o.style.display=""),t[0].style.display="none",n.hasClass("is-active")||n.addClass("is-active"))}))}$("#mainColumn > .content > .b-tabs > .tabs > ul").append(e),$("#mainColumn > .content > .b-tabs > .tab-content").append(t),e.on("click",(function(i){if(1==i.which){for(let e=1;e<=$("#mainColumn > .content > .b-tabs > .tabs > ul").children().length-1;e++){let t=$("#mainColumn > .content > .b-tabs > .tabs > ul > li:nth-child("+e+")"),i=$("#mainColumn > .content > .b-tabs > .tab-content").children()[e-1];t.removeClass("is-active"),i.style.display="none"}e.addClass("is-active"),t[0].style.display=""}}));let i=$('<div class="b-tabs resTabs"></div>'),n=$('<nav class="tabs"></nav>');i.append(n);let o=$('<section class="tab-content"></section>');i.append(o);let r=$("<ul></ul>");if(n.append(r),t.append(i),function(e){let[t,i]=Be("autoPrint","Auto Print","Prints out script details in the script printing window. Currently only action details are implemented. Toggle to ignore certain actions from appearing in the message queue.",!0,e),n=$('<div style="display:flex;"></div>');i.append(n);n.append($(`<div><span class="has-text-warning ${pe}" style="width:12rem;" data-label="Checking these will send the print messages to the script message queue.">Print Settings:</span></div>`));let o=$("<div></div>");n.append(o);for(let e=0;e<st.length;e++){lt.printSettings[st[e]];let t=st[e],i=(ze[e].split("-")[1],st[e]),n=ge(0,t,i,{path:[lt,"printSettings",t]}),r=$("<div></div>");r.append(n),o.append(r)}let[r,l]=Be("autoFarm","Auto Farm","Auto-clicks the manual farming buttons that exist on the screen. If the buttons are not being auto-clicked, try reloading the UI. Defaults to click at 100/s (10 ms).",!0,e),a=ve(lt.farmRate,"farmRate","Farm Rate",{convertFunc:function(e){return isNaN(e)?null:(e=parseInt(e))<=0?null:e},setFunc:function(e){null!==farmInterval&&(clearInterval(farmInterval),farmInterval=null)},toolTip:"Determines how fast the manual buttons will be clicked (every # milliseconds)"});l.append(a);let[s,c]=Be("autoRefresh","Auto Refresh","Automatically reloads the page every 200 seconds. This setting was made due to the modal windows lagging after too many launches. Refreshing will remove this lag.",!1,e),u=$('<div role="button" class="is-primary is-bottom is-small b-tooltip is-animated is-multiline" data-label="Resets the UI and reloads the backend variables."><button class="button is-primary"><span>Reset UI</span></button></div>');u.on("click",(function(e){1==e.which&&(we(),ct(),loadSettings())})),s.append(u);let[d,p]=Be("autoPrestige","Auto Prestige","Automatically prestiges when the options are availible. Maybe will add min prestige resource gain setting if wanted.",!0,e),h=ye(lt.prestige,"prestige","Prestige Choice",{mad:"MAD",bioseed:"Bioseed",blackhole:"Blackhole"});p.append(h)}(Te("General",r,o)),function(e){let[t,i]=Be("autoEvolution","Auto Evolution","Automatically plays the Evolution stage. It will buy the mininum amount of RNA/DNA storage for evolving, as well as automatically purchase challenges.",!0,e),n={};for(let e in window.evolve.races)"protoplasm"!=e&&"junker"!=e&&(n[e]=window.evolve.races[e].name);let o=ye(lt.evolution,"evolution","Evolution Decision",n);i.append(o),i.append($("<br></br>"));let r=$('<div style="display:flex;"></div>');i.append(r),r.append($('<h3 class="has-text-warning" style="width:12rem;">Challenges:</h3>'));let l=$("<div></div>");r.append(l);for(let e=0;e<ze.length;e++){lt[ze[e]];let t=ze[e],i=ze[e].split("-")[1],n=i.charAt(0).toUpperCase()+i.slice(1),o=ge(0,t+"_checkbox",n,{path:[lt,t]}),r=$("<div></div>");r.append(o),l.append(r)}}(Te("Evolution",r,o)),!_t()){!function(e){let[t,i]=Be("autoTax","Auto Tax","Manages the tax rate for optimal morale and taxes.",!0,e),n=$('<div style="display:flex;"></div>');i.append(n);let o=$('<span class="has-text-warning" style="width:12rem;">Minimum Morale:</span>');n.append(o);let r=he(lt.minimumMorale,"minimum_morale",(function(e){return lt.minimumMorale-=e,lt.minimumMorale<50&&(lt.minimumMorale=50),lt.minimumMorale}),(function(e){return lt.minimumMorale+=e,lt.minimumMorale}));n.append(r);let[l,a]=Be("autoEmploy","Auto Employ","Allocates the population to jobs. May add min/max settings later on.",!0,e,Re,Ie);Le(a);let[s,c]=Be("autoBattle","Auto Battle","Automatically runs battle campaigns. Will choose the highest campaign that allows for the minimum win rate. You can limit the highest campaign as well, as Siege is always less efficient.",!0,e);!function(e){let t=$('<div style="display:flex;"></div>');e.append(t);let i=ye(lt.maxCampaign,"maxCampaign","Max Campaign",{0:"Ambush",1:"Raid",2:"Pillage",3:"Assault",4:"Siege"});t.append(i),t.append($('<div style="width:6rem;"></div>'));let n=ge(lt.woundedCheck,"woundedCheck","Check Wounded",{toolTip:"Enable to stop running campaigns if there are wounded soldiers. Disable to run campaigns as soon as there are enough healthy soldiers to fight. Disabling causes more lag due to the algorithm running continously."});t.append(n),e.append($("<br></br>"));let o=function(e){return isNaN(e)?null:(e=parseFloat(e))<0||e>100?null:e},r=ve(lt.minWinRate,"minWinRate","Minimum Win Rate",{convertFunc:o});e.append(r),e.append($("<br></br>"));let l=$('<div style="display:flex;"></div>');e.append(l);o=function(e){return isNaN(e)?null:(e=parseFloat(e))<0?null:e};let a=ve(lt.campaignFailInterval,"campaignFailInterval","Campaign Fail Interval",{convertFunc:o,toolTip:"Sets the time in seconds to wait after a failed campaign check."});l.append(a),l.append($('<div style="width:6rem;"></div>'));let s=ge(lt.campaignFailCheck,"campaignFailCheck","Fail Check",{toolTip:"Enable to stop Auto Battle for an time if the campaign algorithm fails. This is to stop infinite loops when the algorithm cannot find a optimal battle."});l.append(s)}(c);let[u,d]=Be("autoFortress","Auto Fortress","Manages soldier allocation in the fortress. Currently not yet implemented.",!0,e)}(Te("Jobs/Army",r,o)),function(e){let[t,i]=Be("autoCraft","Auto Craft","Crafts resources if the required resources are above 90% full. Only works when Manual Crafting is enabled (disabled in No Craft challenge).",!0,e),n=0,o=$('<div style="display:flex" class="alt market-item"></div>');i.append(o);let r=$('<span class="has-text-warning" style="width:12rem;">Craftable Resource</h3>');o.append(r);let l=$('<span class="has-text-warning" style="width:12rem;">Enable</h3>');for(var a in o.append(l),w){if(!(w[a]instanceof b))continue;let e=null;e=(n+=1)%2?$('<div style="display:flex" class="market-item"></div>'):$('<div style="display:flex" class="alt market-item"></div>'),i.append(e);let t=$(`<span class="has-text-danger" style="width:12rem;">${w[a].name}</h3>`);e.append(t);let o=me(a+"_enabled","",{path:[w,a,"enabled"],small:!0});e.append(o)}let[s,c]=Be("autoMarket","Auto Market","Buys/sells resources when they are below/above a certain storage ratio. This also makes sure when buying that the money never goes under the minimum value. Only works when Manual Trading is enabled (disabled in No Trade challenge).",!0,e,_e,xe),u=$('<div style="display:flex;"></div>');c.append(u),c.append($("<br></br>")),u.append($('<h3 class="has-text-warning" style="width:12rem;">Market Volume:</h3>'));let d=$('<select style="width:12rem;">\n                        <option value="1">10x</option>\n                        <option value="2">25x</option>\n                        <option value="3">100x</option>\n                        <option value="4">250x</option>\n                        <option value="5">1000x</option>\n                        <option value="6">2500x</option>\n                        <option value="7">10000x</option>\n                        <option value="8">25000x</option>\n                        </select>');d[0].value=lt.marketVolume,d[0].onchange=function(){lt.marketVolume=d[0].value,console.log("Changing market volume to ",lt.marketVolume),ct()},u.append(d);let p=ve(lt.minimumMoney,"minimumMoney","Minimum Money",{convertFunc:function(e){return e=getRealValue(e),isNaN(e)?null:e}});c.append(p);let[h,m]=Be("autoTrade","Auto Trade","Allocates trade routes based on the trade priority (as well as Auto Prioritize).",!0,e,Ce,Oe);Ee(m);let[y,g]=Be("autoStorage","Auto Storage","Allocates crates and containers to resources based on priority. Also has a minimum storage setting for steel and other resources that need initial storage.",!0,e,Se,Pe);qe(g);let[v,f]=Be("autoEjector","Auto Ejector","Automatically ejects resources to maximize ejection volume. Full resources will override the enable setting (If a resource is full, it'll be seen as enabled). Enabling a resource will eject the resource until the rate is close to 0.",!0,e,Me,Ae);!function(e){let t=$('<div style="display:flex" class="alt market-item"></div>');e.append(t);let i=$('<span class="has-text-warning" style="width:12rem;">Ejectable Resource</h3>');t.append(i);let n=$('<span class="has-text-warning" style="width:12rem;">Enable</h3>');t.append(n);let o=0;for(var r in w){if(!w[r].ejectable)continue;let t=null;t=(o+=1)%2?$('<div style="display:flex" class="market-item"></div>'):$('<div style="display:flex" class="alt market-item"></div>'),e.append(t);let i=$(`<span class="${w[r].color}" style="width:12rem;">${w[r].name}</h3>`);t.append(i);let n=me(r+"_eject","",{path:[w,r,"eject"],small:!0});t.append(n)}}(f)}(Te("Resources",r,o)),function(e){let[t,i]=Be("autoSupport","Auto Support","Powers buildings and allocates support. Power Priority can be changed in the Priority Tab.",!0,e);!function(e){let t=Ne("supportSettings","Interval","Interval","This setting will determine how many script cycles before the setting will trigger.");e.append(t),e.append($("<br>"))}(i);let[n,o]=Be("autoSmelter","Auto Smelter","Allocates the smelter building. The priorities determine how much each resource is weighted. Can choose whether to depend on the Auto Priority queue or just the priorities here.",!0,e);!function(e){let t=Ne("smelterSettings","Interval","Interval","This setting will determine how many script cycles before the setting will trigger.");e.append(t),e.append($("<br>"));let i=Ne("smelterSettings","Wood","Wood Priority"),n=Ne("smelterSettings","Coal","Coal Priority"),o=Ne("smelterSettings","Oil","Oil Priority");e.append(i),e.append(n),e.append(o),e.append($("<br>"));let r=Ne("smelterSettings","Iron","Iron Priority"),l=Ne("smelterSettings","Steel","Steel Priority");e.append(r),e.append(l)}(o);let r=ge(lt.smelterSettings.pqCheck,"smelterPQCheck","Auto Priority",{path:[lt,"smelterSettings","pqCheck"],toolTip:"Enable to make Auto Smelter depend on the Auto Priority queue."});n.append(r);let[l,a]=Be("autoFactory","Auto Factory","Allocates the factory building. The priorities determine how much each resource is weighted. Can choose whether to depend on the Auto Priority queue or just the priorities here.",!0,e);!function(e){let t=Ne("factorySettings","Interval","Interval","This setting will determine how many script cycles before the setting will trigger.");e.append(t),e.append($("<br>"));let i=Ne("factorySettings","Luxury_Goods","Luxury Goods Priority"),n=Ne("factorySettings","Alloy","Alloy Priority"),o=Ne("factorySettings","Polymer","Polymer Priority"),r=Ne("factorySettings","Nano_Tube","Nano Tube Priority"),l=Ne("factorySettings","Stanene","Stanene Priority");e.append(i),e.append(n),e.append(o),e.append(r),e.append(l)}(a);let s=ge(lt.factorySettings.pqCheck,"factoryPQCheck","Auto Priority",{path:[lt,"factorySettings","pqCheck"],toolTip:"Enable to make Auto Factory depend on the Auto Priority queue."});l.append(s);let[c,u]=Be("autoDroid","Auto Mining Droid","Allocates mining droids. The priorities determine how much each resource is weighted. Can choose whether to depend on the Auto Priority queue or just the priorities here.",!0,e);!function(e){let t=Ne("droidSettings","Interval","Interval","This setting will determine how many script cycles before the setting will trigger.");e.append(t),e.append($("<br>"));let i=Ne("droidSettings","Adamantite","Adamantite Priority"),n=Ne("droidSettings","Uranium","Uranium Priority"),o=Ne("droidSettings","Coal","Coal Priority"),r=Ne("droidSettings","Aluminium","Aluminium Priority");e.append(i),e.append(n),e.append(o),e.append(r)}(u);let d=ge(lt.droidSettings.pqCheck,"droidPQCheck","Auto Priority",{path:[lt,"droidSettings","pqCheck"],toolTip:"Enable to make Auto Droid depend on the Auto Priority queue."});c.append(d);let[p,h]=Be("autoGraphene","Auto Graphene Plants","Allocates graphene plants. The priorities determine how much each resource is weighted. Can choose whether to depend on the Auto Priority queue or just the priorities here.",!0,e);!function(e){let t=Ne("grapheneSettings","Interval","Interval","This setting will determine how many script cycles before the setting will trigger.");e.append(t),e.append($("<br>"));let i=Ne("grapheneSettings","Wood","Wood Priority"),n=Ne("grapheneSettings","Coal","Coal Priority"),o=Ne("grapheneSettings","Oil","Oil Priority");e.append(i),e.append(n),e.append(o),e.append($("<br>"))}(h);let m=ge(lt.grapheneSettings.pqCheck,"graphenePQCheck","Auto Priority",{path:[lt,"grapheneSettings","pqCheck"],toolTip:"Enable to make Auto Graphene depend on the Auto Priority queue."});p.append(m)}(Te("Buildings",r,o)),function(e){let[t,i]=Be("autoResearch","Auto Research","Controls which research branches to take. Turning this off will have irregular research purchases.",!0,e),n=$("<div><span>This setting chooses between Fanaticism and Anthropology. This setting becomes obsolete after getting Transcendence.</span></div>");i.append(n);let o=ye(lt.religion1,"religion1","Religion Tier 1",{fanaticism:"Fanaticism",anthropology:"Anthropology"});i.append(o);let r=$("<div><span>This setting chooses between Study and Deify Ancients.</span></div>");i.append(r);let l=ye(lt.religion2,"religion2","Religion Tier 2",{study:"Study Ancients",deify:"Deify Ancients"});i.append(l);let a=$("<div><span>This setting chooses between Unifying or Reject Unification.</span></div>");i.append(a);let s=ye(lt.unify,"unify","Unification",{unify:"Unify",reject:"Reject"});i.append(s)}(Te("Research",r,o)),function(e){let[t,i]=Be("autoPriority","Auto Priority","Main Priority System. Creates a priority queue for all the buildings/research/misc. The priority queue can also be used to manage allocation for other settings (smelter, trade, etc). This will probably be heavily reworked in the future.",!1,e);!function(e){let t=$('<div><h3 class="name has-text-warning" title="Set the Priority settings">Actions:</h3></div></br>');e.append(t);let i=$('<div id="prioritySettingsDiv" style="overflow:auto"></div>'),n=$('<div id="prioritySettingsLeft" style="float:left"></div>'),o=$('<div id="prioritySettingsRight" style="float:right"></div>'),r=$('<div id="prioritySettingsTopLeft"></div>'),l=$('<div id="prioritySettingsBottomLeft"></div>'),a=$('<div id="prioritySettingsTopRight" style="float:right"></div>'),s=$('<div id="prioritySettingsBottomRight"></div>'),c=$('<input type="text" id="priorityInput" placeholder="Search for actions (ex: \'iron loc:city res:money\')" style="width:20rem;">');c.on("input",Ue);let u=$('<span style="padding-left:20px;padding-right:20px;">Sort:</span>'),d=$('<select style="width:110px;" id="prioritySort"><option value="none">None</option><option value="name">Name</option><option value="priority">Priority</option><option value="powerPriority">Power Priority</option></select>');d.on("change",Ue),r.append(c).append(u).append(d);let p=ge(lt.showAll,"showAll","Show All",{enabledCallBack:Ue,disabledCallBack:Ue}),h=ge(lt.showBuilding,"showBuilding","Show Buildings",{enabledCallBack:Ue,disabledCallBack:Ue}),m=ge(lt.showResearch,"showResearch","Show Researches",{enabledCallBack:Ue,disabledCallBack:Ue}),y=ge(lt.showMisc,"showMisc","Show Misc.",{enabledCallBack:Ue,disabledCallBack:Ue});l.append(p).append(h).append(m).append(y);let g=$('<span style="padding-right:10px;">Enable:</span>'),v=$('<a class="button is-dark is-small" id="enable-all-btn"><span>All</span></a>');v.on("click",(function(e){if(1!=e.which)return;let t=$("#priorityList")[0];for(let e=1;e<t.childNodes.length;e++)We(t.childNodes[e].id.split("=")[0]).enabled=!0;He(),Ue()}));let f=$('<a class="button is-dark is-small" id="enable-vis-btn"><span>Visible</span></a>');f.on("click",(function(e){if(1!=e.which)return;let t=$("#priorityList")[0];for(let e=1;e<t.childNodes.length;e++)"none"!==t.childNodes[e].style.display&&(We(t.childNodes[e].id.split("=")[0]).enabled=!0);He(),Ue()})),a.append(g).append(v).append(f);let w=$('<span style="padding-right:10px;">Disable:</span>'),b=$('<a class="button is-dark is-small" id="disable-all-btn"><span>All</span></a>');b.on("click",(function(e){if(1!=e.which)return;let t=$("#priorityList")[0];for(let e=1;e<t.childNodes.length;e++)We(t.childNodes[e].id.split("=")[0]).enabled=!1;He(),Ue()}));let S=$('<a class="button is-dark is-small" id="disable-vis-btn"><span>Visible</span></a>');S.on("click",(function(e){if(1!=e.which)return;let t=$("#priorityList")[0];for(let e=1;e<t.childNodes.length;e++)"none"!==t.childNodes[e].style.display&&(We(t.childNodes[e].id.split("=")[0]).enabled=!1);He(),Ue()})),s.append(w).append(b).append(S),n.append(r).append(l),o.append(a).append(s),i.append(n).append(o),e.append(i);let P=$('<div id="priorityList"></div>'),k=$(`<div style="display:flex;">\n                                <div style="width:20%;text-align:left;padding-left:1rem;"><span class="name has-text-warning ${pe}" data-label="Action Name. Can be lowercase id if not currently available">Action</span></div>\n                                <div style="width:10%;text-align:center;padding-left:1rem;"><span class="name has-text-warning ${pe}" data-label="Sets the priority of this action">Priority</span></div>\n                                <div style="width:10%;text-align:center;padding-left:1rem;"><span class="name has-text-warning ${pe}" data-label="Enables this action for being automatically taken">Enabled</span></div>\n                                <div style="width:10%;text-align:center;padding-left:1rem;"><span class="name has-text-warning ${pe}" data-label="Will focus on buying this amount of this building before anything else.">Min</span></div>\n                                <div style="width:10%;text-align:center;padding-left:1rem;"><span class="name has-text-warning ${pe}" data-label="Will stop building this building after reaching this limit">Max</span></div>\n                                <div style="width:10%;text-align:center;padding-left:1rem;"><span class="name has-text-warning ${pe}" data-label="Will softcap this building after reaching this limit, however will still build if resources full">Soft Cap</span></div>\n                                <div style="width:10%;text-align:center;padding-left:1rem;"><span class="name has-text-warning ${pe}" data-label="Sets the priority for powering this building">Power</span></div>\n                                </div>`);P.append(k),e.append(P),He(),Ue()}(e)}(Te("Priority",r,o))}}(),lt.autoStorage&&0==$(".as-storage-settings").length&&Se(),lt.autoEmploy&&0==$(".as-employ-settings").length&&Re(),lt.autoMarket&&0==$(".as-market-settings").length&&_e(),lt.autoTrade&&0==$(".as-trade-settings").length&&Ce(),0==$("#autoSettings").length&&function(){let e=function(e){let t=$("#mainColumn > .content > .b-tabs > .tabs > ul > li > a > span");for(let i=0;i<t.length;i++)if(t[i].innerText.trim()==e){let e=i+1;return t=null,document.querySelector("#mainColumn > .content > .b-tabs > .tab-content > div:nth-child("+e+")")}return t=null,null}("Settings");e.append($("<br></br>")[0]);let t=$('<div id="autoSettings"></div>'),i=$('<label class="label">Import/Export Auto Settings</label>'),n=$('<div class="control is-clearfix"></div>'),o=$('<textarea id="settingsImportExport" class="textarea"></textarea>');n.append(o);let r=$('<div class="field"></div>');r.append(i).append(n);let l=$('<button class="button">Import Settings</button><text> </text>');l.on("click",(function(e){1==e.which&&importSettings()}));let a=$('<button class="button">Export Settings</button>');a.on("click",(function(e){1==e.which&&exportSettings()})),t.append(r).append(l).append(a),e.append(t[0])}(),0==$("#as-watermark").length&&function(){let e=$(`<div id="as-watermark" style="text-align:center"><span>Evolve AutoScript by HLXII - Version <a href="${At}">${Rt}</a></span></div>`);$("#resources").append(e)}()}function we(){console.log("Resetting UI"),Pe(),xe(),Oe(),Ie(),$(".as-autolog").remove(),$(".as-settings").remove(),$("#autoSettings").remove()}function be(e){if(!w[e].unlocked)return;if(!w[e].crateable)return;let t=$("#stack-"+w[e].id),i=$('<div class="as-storage-settings" style="display:flex"></div>'),n=he(w[e].storePriority,e+"-store-priority",(function(t){return w[e].decStorePriority(t),qe(),w[e].storePriority}),(function(t){return w[e].incStorePriority(t),qe(),w[e].storePriority}));i.append(n);let o=he(w[e].storeMin,e+"-store-min",(function(t){return w[e].decStoreMin(t),qe(),w[e].storeMin}),(function(t){return w[e].incStoreMin(t),qe(),w[e].storeMin}));i.append(o);let r=he(w[e].storeMax,e+"-store-max",(function(t){return w[e].decStoreMax(t),qe(),w[e].storeMax}),(function(t){return w[e].incStoreMax(t),qe(),w[e].storeMax}));i.append(r),t.append(i)}function Se(){if(!y("tech-containerization"))return;Pe();let e=$("#createHead"),t=$('<div class="as-storage-settings" style="display:inline-flex;margin-left:2rem"><span class="has-text-warning">Priority</span></div>'),i=$('<div class="as-storage-settings" style="display:inline-flex;margin-left:3rem"><span class="has-text-warning">Min</span></div>'),n=$('<div class="as-storage-settings" style="display:inline-flex;margin-left:3rem"><span class="has-text-warning">Max</span></div>');for(var o in e.append(t).append(i).append(n),w)be(o)}function Pe(){$(".as-storage-settings").remove()}function ke(e){let t=$(`<div style="display:flex;" class="as-market-settings as-market-${e.id}"></div>`),i=$('<div style="display:flex;"></div>');t.append(i);let n=me(e.id+"-autoBuy","",{path:[w,e.id,"autoBuy"],small:!0,onChange:function(t){let i=$(`#${e.id}-autoSell_toggle`),n="true"===i.children("input").attr("value");t&&n&&(i.click(),console.log("Turning off sellToggle"),e.autoSell=!1,i.children("input")[0].setAttribute("value",!1)),Ee()}});i.append(n);let o=he(e.buyRatio,e.id+"-buy-ratio",(function(t){return e.buyDec(t),Ee(),e.buyRatio}),(function(t){return e.buyInc(t),Ee(),e.buyRatio}));i.append(o);let r=$('<div style="display:flex;"></div>');t.append(r);let l=me(e.id+"-autoSell","",{path:[w,e.id,"autoSell"],small:!0,onChange:function(t){let i=$(`#${e.id}-autoBuy_toggle`),n="true"===l.children("input").attr("value");t&&n&&(i.click(),console.log("Turning off buyToggle"),e.autoBuy=!1,i.children("input")[0].setAttribute("value",!1)),Ee()}});r.append(l);let a=he(e.sellRatio,e.id+"-sell-ratio",(function(t){return e.sellDec(t),Ee(),e.sellRatio}),(function(t){return e.sellInc(t),Ee(),e.sellRatio}));return r.append(a),[t,i,r]}function _e(){if(!y("tech-market"))return;xe();let e=document.getElementById("market");e.insertBefore($('<div class="as-market-settings"><br></div>')[0],e.children[1]);let t=!1;for(var i in w){if(!(w[i]instanceof f))continue;let[e,n,o]=ke(w[i]);if(!t){t=!0;let e=$('<div style="position:absolute;top:1.5rem;"><span>Manual Buy</span></div>');n.prepend(e[0]);let i=$('<div style="position:absolute;top:1.5rem;"><span>Manual Sell</span></div>');o.prepend(i[0])}$("#market-"+w[i].id).append(e)}}function xe(){$(".as-market-settings").remove()}function $e(e){let t=$(`<div style="display:flex;" class="as-trade-settings as-trade-${e.id}"></div>`),i=he(e.basePriority,e.id+"-trade-priority",(function(t){return e.decBasePriority(t),Ee(),e.basePriority}),(function(t){return e.incBasePriority(t),Ee(),e.basePriority}));return t.append(i),[t,i]}function Ce(){if(!y("tech-trade"))return;Oe();let e=document.getElementById("market");0==$(".as-market-settings > br").length&&e.insertBefore($('<div class="as-trade-settings"><br></div>')[0],e.children[1]);let t=!1,i=null;for(var n in w){if(!(w[n]instanceof f))continue;let[e,o]=$e(w[n]);if(!t){t=!0;let e=$('<div style="position:absolute;top:1.5rem;"><span>Trade</span></div>');o.prepend(e[0])}let r=$("#market-"+w[n].id);r.append(e),"none"!=r[0].style.display&&(i=[o,e,r])}document.getElementById("tradeTotal");let o=$('<div style="position:absolute;bottom:4rem;width:5.25rem;text-align:center;"><span>$$$</span></div>');i[0].prepend(o);let r=$('<div style="position:absolute;bottom:3rem;width:5.25rem;text-align:center;"</div>'),l=he(w.Money.basePriority,"Money-trade-priority",(function(e){return w.Money.decBasePriority(e),Ee(),w.Money.basePriority}),(function(e){return w.Money.incBasePriority(e),Ee(),w.Money.basePriority}));r.append(l),i[0].prepend(r[0])}function Oe(){$(".as-trade-settings").remove()}function Me(){window.evolve.global.interstellar.hasOwnProperty("mass_ejector")&&0!=window.evolve.global.interstellar.mass_ejector.count&&Ae()}function Ae(){$(".as-ejector-settings").remove()}function Re(){for(var e in Ie(),re){let t=re[e];if(!t.unlocked)continue;let i=function(e){return t.lowerPriority(e),Le(),t._priority},n=function(e){return t.higherPriority(e),Le(),t._priority},o=he(t._priority,t.id+"-priority",i,n);if("free"!=t.id||"Hunter"==t.name)if("craftsman"==t.id){let e=$("#foundry > .job > .foundry").parent(),t=$('<div class="foundry as-employ-settings" style="text-align:right;margin-left:4.5rem"></div>');e.append(t),t.append(o)}else if("free"==t.id){let e=$('<div class="as-employ-settings" style="text-align:right;margin-left:4.5rem"></div>');$("#civ-"+t.id).append(e),e.append(o)}else{let e=$('<div class="as-employ-settings" style="text-align:right;margin-left:1.25rem"></div>');$("#civ-"+t.id).append(e),e.append(o)}else{document.getElementById("civ-"+t.id);let e=$('<span class="has-text-warning as-employ-settings" style="text-align:right;min-width:9.25rem">Priority</span>');$("#civ-"+t.id).append(e)}}for(e in ae){let t=ae[e];if(!t.unlocked)continue;let i=function(e){return t.lowerPriority(e),Le(),t._priority},n=function(e){return t.higherPriority(e),Le(),t._priority},o=he(t._priority,t.id+"-priority",i,n),r=$('<div class="as-employ-settings" style="text-align:right;margin-left:1.25rem">');r.append(o),$("#craft"+t.id).parent().append(r)}}function Ie(){$(".as-employ-settings").remove()}function Te(e,t,i){let n=$('<li class="as-settings"><a><span>'+e+"</span></a></li>"),o=$('<div id="'+e+'_setting_tab" class="tab-item as-settings" style="display:none"><h2 class="is-sr-only">'+e+"</h2></div>");return n.on("click",(function(e){if(1==e.which){for(let e=0;e<t.children().length;e++){let n=t.children()[e],o=i.children()[e];n.classList.contains("is-active")&&(n.classList.remove("is-active"),o.style.display="none")}n.addClass("is-active"),o[0].style.display=""}})),t.append(n),i.append(o),o}function Be(e,t,i,n,o,r,l){let a=$('<div style="display:flex;justify-content:space-between;"></div>');o.append(a);let s=me(e,t,{enabledCallBack:r,disabledCallBack:l});a.append(s);let c=$(`<div><span>${i}</span></div>`);o.append(c),o.append($("<br></br>"));let u=null;if(n){u=$(`<div style="margin-left:2em;" id="${"as-"+e+"-content"}"></div>`),o.append(u),o.append($("<br></br>"))}return[a,u]}function Le(e){null!==e&&null!=e||(e=$("#as-autoEmploy-content")),$(".as-employui").remove();let t=0,i=$('<div style="display:flex" class="alt market-item as-employui"></div>');e.append(i);let n=$('<span class="has-text-warning" style="width:12rem;">Job</span>');i.append(n);let o=$('<span class="has-text-warning" style="width:12rem;">Priority</span>');i.append(o);for(let i in re){let n=i,o=null;o=(t+=1)%2?$('<div style="display:flex" class="market-item as-employui"></div>'):$('<div style="display:flex" class="alt market-item as-employui"></div>'),e.append(o);let r="free"==i?"Hunter":re[i].name,l=$(`<span class="has-text-info" style="width:12rem;">${r}</h3>`);o.append(l);let a=$('<div style="width:12rem;"></div>');o.append(a);let s=function(e){return re[n].lowerPriority(e),Re(),re[n]._priority},c=function(e){return re[n].higherPriority(e),Re(),re[n]._priority},u=he(re[n]._priority,re[n].id+"_priority",s,c);a.append(u)}for(let i in ae){let n=i,o=null;o=(t+=1)%2?$('<div style="display:flex" class="market-item as-employui"></div>'):$('<div style="display:flex" class="alt market-item as-employui"></div>'),e.append(o);let r=$(`<span class="has-text-danger" style="width:12rem;">${ae[i].name}</h3>`);o.append(r);let l=$('<div style="width:12rem;"></div>');o.append(l);let a=function(e){return ae[n].lowerPriority(e),Re(),ae[n]._priority},s=function(e){return ae[n].higherPriority(e),Re(),ae[n]._priority},c=he(ae[n]._priority,ae[n].id+"_priority",a,s);l.append(c)}}function Ee(e){null!==e&&null!=e||(e=$("#as-autoTrade-content")),$(".as-tradeui").remove();let t=0,i=$('<div style="display:flex" class="alt market-item as-tradeui"></div>');e.append(i);let n=$('<span class="has-text-warning" style="width:12rem;">Tradeable Resource</h3>');i.append(n);let o=$('<span class="has-text-warning" style="width:12rem;">Manual Buy</h3>');i.append(o);let r=$('<span class="has-text-warning" style="width:12rem;">Manual Sell</h3>');i.append(r);let l=$('<span class="has-text-warning" style="width:12rem;">Trade Priority</h3>');i.append(l),t+=1;let a=$('<div style="display:flex" class="market-item as-tradeui"></div>');e.append(a);let s=$('<span class="has-text-advanced" style="width:12rem;">Money</span>');a.append(s);let c=$('<div style="width:24rem;"></div>');a.append(c);let u=he(w.Money.basePriority,w.Money.id+"_priority",(function(e){return w.Money.decBasePriority(e),_e(),w.Money.basePriority}),(function(e){return w.Money.incBasePriority(e),_e(),w.Money.basePriority}));for(var d in a.append(u),w){if(!(w[d]instanceof f))continue;let i=d,n=null;n=(t+=1)%2?$('<div style="display:flex" class="market-item as-tradeui"></div>'):$('<div style="display:flex" class="alt market-item as-tradeui"></div>'),e.append(n);var p=$(`<span class="has-text-info" style="width:12rem;">${w[d].name}</h3>`);n.append(p);let o=$('<div style="width:12rem;display:flex;"></div>');n.append(o);let r=function(e){let t=$(`#${i}_autoSell_toggle`),n="true"===t.children("input").attr("value");e&&n&&(t.click(),console.log("Turning off sellToggle"),w[i].autoSell=!1,t.children("input")[0].setAttribute("value",!1)),_e()},l=me(i+"_autoBuy","",{path:[w,i,"autoBuy"],small:!0,onChange:r});o.append(l);let a=function(e){return w[i].buyDec(e),_e(),w[i].buyRatio},s=function(e){return w[i].buyInc(e),_e(),w[i].buyRatio},c=he(w[i].buyRatio,w[i].name+"_buy_ratio",a,s);o.append(c);let u=$('<div style="width:12rem;display:flex;"></div>');n.append(u);let h=function(e){let t=$(`#${i}_autoBuy_toggle`),n="true"===t.children("input").attr("value");e&&n&&(t.click(),console.log("Turning off buyToggle"),w[i].autoBuy=!1,t.children("input")[0].setAttribute("value",!1)),_e()},m=me(i+"_autoSell","",{path:[w,i,"autoSell"],small:!0,onChange:h});u.append(m);let y=function(e){return w[i].sellDec(e),_e(),w[i].sellRatio},g=function(e){return w[i].sellInc(e),_e(),w[i].sellRatio},v=he(w[i].sellRatio,w[i].name+"_sell_ratio",y,g);u.append(v);let b=function(e){return w[i].decBasePriority(e),_e(),w[i].basePriority},S=function(e){return w[i].incBasePriority(e),_e(),w[i].basePriority},P=he(w[i].basePriority,w[i].id+"_priority",b,S);n.append(P)}}function qe(e){null!==e&&null!=e||(e=$("#as-autoStorage-content")),$(".as-storageui").remove();let t=0,i=$('<div style="display:flex" class="alt market-item as-storageui"></div>');e.append(i);let n=$('<span class="has-text-warning" style="width:12rem;">Storable Resource</span>');i.append(n);let o=$('<span class="has-text-warning" style="width:12rem;">Priority</span>');i.append(o);let r=$('<span class="has-text-warning" style="width:12rem;">Minimum Storage</h3>');i.append(r);let l=$('<span class="has-text-warning" style="width:12rem;">Maximum Storage</h3>');for(var a in i.append(l),w){let i=a;if(!w[a].crateable)continue;let n=null;n=(t+=1)%2?$('<div style="display:flex" class="market-item as-storageui"></div>'):$('<div style="display:flex" class="alt market-item as-storageui"></div>'),e.append(n);var s=$(`<span class="has-text-info" style="width:12rem;">${w[a].name}</h3>`);n.append(s);let o=$('<div style="width:12rem;"></div>');n.append(o);let r=function(e){return w[i].decStorePriority(e),Se(),w[i].storePriority},l=function(e){return w[i].incStorePriority(e),Se(),w[i].storePriority},c=he(w[i].storePriority,w[i].id+"_store_priority",r,l);o.append(c);let u=$('<div style="width:12rem;"></div>');n.append(u);let d=function(e){return w[i].decStoreMin(e),Se(),w[i].storeMin},p=function(e){return w[i].incStoreMin(e),Se(),w[i].storeMin},h=he(w[i].storeMin,w[i].id+"_store_min",d,p);u.append(h);let m=$('<div style="width:12rem;"></div>');n.append(m);let y=function(e){return w[i].decStoreMax(e),Se(),w[i].storeMax},g=function(e){return w[i].incStoreMax(e),Se(),w[i].storeMax},v=he(w[i].storeMax,w[i].id+"_store_max",y,g);m.append(v)}}function Ne(e,t,i,n){let o=$(`<span class="has-text-warning" style="width:12rem;">${i}:</span>`);n&&(o.addClass(pe),o.attr("data-label",n));let r=he(lt[e][t],`${e}_${t}`,(function(i){return lt[e][t]-=i,lt[e][t]<0&&(lt[e][t]=0),lt[e][t]}),(function(i){return lt[e][t]+=i,lt[e][t]}));return $('<div style="display:flex"></div>').append(o).append(r)}function Fe(e,t){return e.name.localeCompare(t.name)}function De(e,t){return t.basePriority-e.basePriority}function je(e,t){return(t instanceof O?t.powerPriority:-1)-(e instanceof O?e.powerPriority:-1)}function We(e){let[t,i]=e.split("-"),n=null;return n=void 0===i?"Container"==t||"Crate"==t?Q[t]:"Gene"==t||"Mercenary"==t||"FortressMercenary"==t||"Sacrifice"==t?te[t]:z[t]:"tech"==t?m[e]:A[e]}function Ue(){console.log("Updating Priority List");let e=$("#priorityInput")[0],t=$("#prioritySort")[0],i=$("#priorityList")[0],n=e.value.split(" "),o=[],r=[],l=[];for(let e=0;e<n.length;e++){let t=/loc:(.+)/.exec(n[e]),i=/res:(.+)/.exec(n[e]);null!==t?r.push(t[1]):null!==i?l.push(i[1]):o.push(n[e])}let a=null;if("name"==t.value?a=Fe:"priority"==t.value?a=De:"powerPriority"==t.value&&(a=je),null!==a){console.log("Sorting by",t.value);var s=i.cloneNode(!1);let e=i.childNodes[0];var c=[];for(let e=1;e<i.childNodes.length;e++)c.push(i.childNodes[e]);c.sort((function(e,t){let i=We(t.id.split("=")[0]),n=We(e.id.split("=")[0]);return a(n,i)})),console.log(c[0]),s.appendChild(e);for(let e=0;e<c.length;e++)s.appendChild(c[e]);i.parentNode.replaceChild(s,i),i=s}for(let e=1;e<i.children.length;e++){let t=i.children[e],n=We(t.id.split("=")[0]);if(lt.showAll||n.unlocked)if(lt.showBuilding||!(n instanceof C)||n instanceof H)if(!lt.showResearch&&n instanceof h)t.style.display="none";else if(lt.showMisc||!(n instanceof G||n instanceof H)){if(0!=o.length){let e=!1;for(let t=0;t<o.length;t++){if((null!==n.name?n.name:n.id.split("-")[1]).toLowerCase().indexOf(o[t])>=0){e=!0;break}}if(!e){t.style.display="none";continue}}if(0!=r.length){let e=!1;for(let t=0;t<r.length;t++)if(n.loc.includes(r[t])){e=!0;break}if(!e){t.style.display="none";continue}}if(0!=l.length&&null!==n.res){let e=!1;for(let t=0;t<l.length;t++)if(console.log(n.id,l,n.def.cost,n.getResDep(l[t])),null!==n.getResDep(l[t])&&n.getResDep(l[t])>0){e=!0;break}if(!e){t.style.display="none";continue}}t.style.display="flex"}else t.style.display="none";else t.style.display="none";else t.style.display="none"}e.focus()}function Ge(e,t){let i=he(e.atLeast,e.id+"-min",(function(t){return e.decAtLeast(t),e.atLeast}),(function(t){return e.incAtLeast(t),e.atLeast})),n=$('<div style="width:10%;" title="'+e.id+' Minimum"></div>');n.append(i),t.append(n);let o=he(e.limit,e.id+"-max",(function(t){return e.decLimit(t),e.limit}),(function(t){return e.incLimit(t),e.limit})),r=$('<div style="width:10%;" title="'+e.id+' Maximum"></div>');r.append(o),t.append(r);let l=he(e.softCap,e.id+"-softcap",(function(t){return e.decSoftCap(t),e.softCap}),(function(t){return e.incSoftCap(t),e.softCap})),a=$('<div style="width:10%;" title="'+e.id+' Soft Cap"></div>');if(a.append(l),t.append(a),e instanceof O){let i=function(t){return e.decPowerPriority(t),e.powerPriority},n=function(t){return e.incPowerPriority(t),e.powerPriority},o=he(e.powerPriority,e.id+"-power-prio",i,n),r=$('<div style="width:10%;" title="'+e.id+' Power Priority"></div>');r.append(o),t.append(r)}}function He(){let e=$("#priorityList")[0];var t,i;let n=[];for(t in A)n.push(A[t]);for(t in m)n.push(m[t]);for(t in z)n.push(z[t]);for(t in Q)n.push(Q[t]);for(t in te)n.push(te[t]);for(;1!=e.childNodes.length;)e.removeChild(e.lastChild);for(let t=0;t<n.length;t++){let r=n[t];var o;o=t%2?$('<div id="'+r.id+'=prio" style="display:flex" class="market-item"></div>'):$('<div id="'+r.id+'=prio" style="display:flex" class="resource alt market-item"></div>'),e.appendChild(o[0]),i=null===r.name?r.id.split("-")[1]:r.name;let l=$(`<span class="${pe}" style="width:20%;" data-label="Id:${r.id}, Loc:${r.loc[r.loc.length-1]}">${i}</span>`);l[0].classList.add(r.color),o.append(l);let a=function(e){return r.decBasePriority(e),r.basePriority},s=function(e){return r.incBasePriority(e),r.basePriority},c=he(r.basePriority,"action_"+i+"_priority",a,s),u=$('<div style="width:10%;" title="'+r.id+' Priority"></div>');u.append(c),o.append(u);let d=$('<div style="width:10%;" title="'+r.id+' Enabled"></div>');o.append(d);let p=me(r.id+"_enabled","",{path:[r,"enabled"],small:!0});d.append(p),r instanceof C&&Ge(r,o)}}const Ke=["evo-rna","evo-dna"],Ve=["evo-phagocytosis","evo-chitin","evo-chloroplasts","evo-eggshell","evo-mammals","evo-athropods","evo-ectothermic","evo-endothermic","evo-humanoid","evo-gigantism","evo-animalism","evo-dwarfism","evo-aquatic","evo-demonic","evo-entish","evo-cacti","evo-sporgar","evo-shroomi","evo-arraak","evo-pterodacti","evo-dracnid","evo-tortoisan","evo-gecko","evo-slitheryn","evo-human","evo-elven","evo-orc","evo-orge","evo-cyclops","evo-troll","evo-kobold","evo-goblin","evo-gnome","evo-cath","evo-wolven","evo-centaur","evo-mantis","evo-scorpid","evo-antid","evo-sharkin","evo-octigoran","evo-balorg","evo-imp","evo-seraph","evo-unicorn"],ze=["evo-plasmid","evo-mastery","evo-trade","evo-craft","evo-crispr","evo-junker","evo-joyless","evo-decay"],Je=["evo-junker","evo-joyless","evo-decay"],Qe=["uni-standard","uni-heavy","uni-antimatter","uni-evil","uni-micro"],Ye={entish:["evo-chloroplasts","evo-entish"],cacti:["evo-chloroplasts","evo-cacti"],sporgar:["evo-chitin","evo-sporgar"],shroomi:["evo-chitin","evo-shroomi"],arraak:["evo-phagocytosis","evo-eggshell","evo-endothermic","evo-arraak"],pterodacti:["evo-phagocytosis","evo-eggshell","evo-endothermic","evo-pterodacti"],dracnid:["evo-phagocytosis","evo-eggshell","evo-endothermic","evo-dracnid"],tortoisan:["evo-phagocytosis","evo-eggshell","evo-ectothermic","evo-tortoisan"],gecko:["evo-phagocytosis","evo-eggshell","evo-ectothermic","evo-gecko"],slitheryn:["evo-phagocytosis","evo-eggshell","evo-ectothermic","evo-slitheryn"],human:["evo-phagocytosis","evo-mammals","evo-humanoid","evo-human"],elven:["evo-phagocytosis","evo-mammals","evo-humanoid","evo-elven"],orc:["evo-phagocytosis","evo-mammals","evo-humanoid","evo-orc"],orge:["evo-phagocytosis","evo-mammals","evo-gigantism","evo-orge"],cyclops:["evo-phagocytosis","evo-mammals","evo-gigantism","evo-cyclops"],troll:["evo-phagocytosis","evo-mammals","evo-gigantism","evo-troll"],kobold:["evo-phagocytosis","evo-mammals","evo-dwarfism","evo-kobold"],goblin:["evo-phagocytosis","evo-mammals","evo-dwarfism","evo-goblin"],gnome:["evo-phagocytosis","evo-mammals","evo-dwarfism","evo-gnome"],cath:["evo-phagocytosis","evo-mammals","evo-animalism","evo-cath"],wolven:["evo-phagocytosis","evo-mammals","evo-animalism","evo-wolven"],centaur:["evo-phagocytosis","evo-mammals","evo-animalism","evo-centaur"],mantis:["evo-phagocytosis","evo-athropods","evo-mantis"],scorpid:["evo-phagocytosis","evo-athropods","evo-scorpid"],antid:["evo-phagocytosis","evo-athropods","evo-antid"],sharkin:["evo-phagocytosis","evo-aquatic","evo-sharkin"],octigoran:["evo-phagocytosis","evo-aquatic","evo-octigoran"],octigoran:["evo-phagocytosis","evo-aquatic","evo-octigoran"],balorg:["evo-phagocytosis","evo-mammals","evo-demonic","evo-balorg"],imp:["evo-phagocytosis","evo-mammals","evo-demonic","evo-imp"],seraph:["evo-phagocytosis","evo-mammals","evo-angelic","evo-seraph"],unicorn:["evo-phagocytosis","evo-mammals","evo-angelic","evo-unicorn"]};var Xe={};function Ze(){(Xe={})["evo-organelles"]=2,Xe["evo-nucleus"]=1;let e=320;(function(e){let t="";switch(e){case"Morphogenesis":t=/Evolution costs decreased/;break;default:return!1}let i=$("#perksPanel > div");for(let e=0;e<i.length;e++)if(null!==t.exec(i[e].innerText))return!0;return!1})("Morphogenesis")&&(e*=.8);let t=100;-1!=xt("Creator")&&(t+=50*(xt("Creator")-1));let i=1e3;for(let n=0;n<10;n++){let o=n,r=Math.ceil(((e-t)/o-10)/10);o+r<=i&&(Xe["evo-eukaryotic_cell"]=o,Xe["evo-mitochondria"]=r,i=o+r)}Xe["evo-membrane"]=Math.ceil((e-t)/(5*Xe["evo-mitochondria"]+5)),Xe["evo-membrane"]=Xe["evo-membrane"]<=0?1:Xe["evo-membrane"],Xe["evo-eukaryotic_cell"]=Xe["evo-eukaryotic_cell"]<=0?1:Xe["evo-eukaryotic_cell"],Xe["evo-mitochondria"]=Xe["evo-mitochondria"]<=0?1:Xe["evo-mitochondria"]}const et={Lux:{demand:[.14,.21,.28,.35],fur:[2,3,4,5]},Alloy:{copper:[.75,1.12,1.49,1.86],aluminium:[1,1.5,2,2.5],output:[.075,.112,.149,.186]},Polymer:{oil_kk:[.22,.33,.44,.55],oil:[.18,.27,.36,.45],lumber:[15,22,29,36],output:[.125,.187,.249,.311]},Nano_Tube:{coal:[8,12,16,20],neutronium:[.05,.075,.1,.125],output:[.2,.3,.4,.5]},Stanene:{aluminium:[30,45,60,75],nano:[.02,.03,.04,.05],output:[.6,.9,1.2,1.5]}};function tt(){let e=1;if(window.evolve.global.space.ziggurat&&window.evolve.global.space.ziggurat.count>0){let t=window.evolve.global.tech.ancient_study?.006:.004;e+=window.evolve.global.space.ziggurat.count*window.evolve.global.civic.colonist.workers*t}return e}async function it(e){if(!y("tech-steel"))return;if(!await _($("#city-smelter > .special")))return;let t=function(){let e=$(".fuels > span"),t={};if(!window.evolve.global.race.kindling_kindred||window.evolve.global.race.evil){t.Wood={},t.Wood.decBtn=e[0],t.Wood.incBtn=e[2];let i=e[1].attributes["data-label"].value;i=/Consume ([\d\.]+) ([\w]+)/.exec(i),t.Wood.num=window.evolve.global.city.smelter.Wood,t.Wood.fuel=parseFloat(i[1]),t.Wood.name=i[2]}if(window.evolve.global.resource.Coal.display){t.Coal={},t.Coal.decBtn=t.Wood?e[3]:e[0],t.Coal.incBtn=t.Wood?e[5]:e[2];let i=t.Wood?e[4].attributes["data-label"].value:e[1].attributes["data-label"].value;t.Coal.fuel=parseFloat(/Burn ([\d\.]+).*/.exec(i)[1]),t.Coal.num=window.evolve.global.city.smelter.Coal}if(window.evolve.global.resource.Oil.display){t.Oil={},t.Oil.decBtn=t.Wood?e[6]:e[3],t.Oil.incBtn=t.Wood?e[8]:e[5];let i=t.Wood?e[7].attributes["data-label"].value:e[4].attributes["data-label"].value;t.Oil.fuel=parseFloat(/Burn ([\d\.]+).*/.exec(i)[1]),t.Oil.num=window.evolve.global.city.smelter.Oil}t.Iron={},t.Iron.num=window.evolve.global.city.smelter.Iron,t.Iron.btn=document.querySelector(".smelting > span:nth-child(1) > button");let i=t.Iron.btn.parentElement.attributes["data-label"].value;if(t.Iron.percent=parseInt(/[^\d]+([\d]+)%/.exec(i)[1]),window.evolve.global.resource.Steel.display&&window.evolve.global.tech.smelting>=2){t.Steel={},t.Steel.num=window.evolve.global.city.smelter.Steel,t.Steel.btn=document.querySelector(".smelting > span:nth-child(2) > button");let e=t.Steel.btn.parentElement.attributes["data-label"].value,i=/[^\d\.]*([\d\.]+)[^\d\.]*([\d\.]+)[^\d\.]*([\d\.]+)[^\d\.]*/.exec(e);t.Steel.Coal=parseFloat(i[1]),t.Steel.Iron=parseFloat(i[2]),t.Steel.produce=parseFloat(i[3])}return t}();console.log("Smelter Data:",t);let i=A["city-smelter"].numTotal;if(t.hasOwnProperty("Wood"))switch(t.Wood.name){case"Lumber":w.Lumber.temp_rate+=t.Wood.fuel*t.Wood.num;break;case"Souls":w.Food.temp_rate+=t.Wood.fuel*t.Wood.num;break;case"Flesh":w.Furs.temp_rate+=t.Wood.fuel*t.Wood.num}t.hasOwnProperty("Coal")&&(w.Coal.temp_rate+=t.Coal.fuel*t.Coal.num),t.hasOwnProperty("Oil")&&(w.Oil.temp_rate+=t.Oil.fuel*t.Oil.num),w.Iron.temp_rate+=t.Steel.Iron*t.Steel.num,w.Coal.temp_rate+=t.Steel.Coal*t.Steel.num,w.Steel.temp_rate-=t.Steel.produce*t.Steel.num,w.Iron.temp_rate/=1+t.Iron.percent*t.Iron.num/100;let n=[],o=[],r=0,l=[];if(t.hasOwnProperty("Wood")){n.push("Wood");let i=lt.smelterSettings.Wood;if(e)switch(t.Wood.name){case"Lumber":null!==e.Lumber?i/=e.Lumber.priority:i=1e5;break;case"Souls":null!==e.Food?i/=e.Food.priority:i=1e5;break;case"Flesh":null!==e.Furs?i/=e.Furs.priority:i=1e5}o.push(i)}if(t.hasOwnProperty("Coal")){n.push("Coal");let t=lt.smelterSettings.Coal;e&&(null!==e.Coal?t/=e.Coal.priority:t=1e10),o.push(t)}if(t.hasOwnProperty("Oil")){n.push("Oil");let t=lt.smelterSettings.Oil;e&&(null!==e.Oil?t/=e.Oil.priority:t=1e20),o.push(t)}for(let e=0;e<o.length;e++)r+=o[e];for(let e=0;e<o.length;e++)l.push(o[e]/r);let a=function(e,i){switch(n[e]){case"Wood":switch(t.Wood.name){case"Lumber":return w.Lumber.temp_rate>t.Wood.fuel;case"Souls":return w.Food.temp_rate>t.Wood.fuel;case"Flesh":return w.Furs.temp_rate>t.Wood.fuel}break;case"Coal":return w.Coal.temp_rate>t.Coal.fuel;case"Oil":return w.Oil.temp_rate>t.Oil.fuel}return!1},s=function(e,i){switch(n[e]){case"Wood":switch(t.Wood.name){case"Lumber":w.Lumber.temp_rate-=t.Wood.fuel;break;case"Souls":w.Food.temp_rate-=t.Wood.fuel;break;case"Flesh":w.Furs.temp_rate-=t.Wood.fuel}break;case"Coal":w.Coal.temp_rate-=t.Coal.fuel;break;case"Oil":w.Oil.temp_rate-=t.Oil.fuel}},c=ft(i,o,l,{requireFunc:a,allocFunc:s});console.log("SMELTER FUEL:",c);let u=[],d=[],p=0,h=[];if(t.hasOwnProperty("Iron")){u.push("Iron");let t=lt.smelterSettings.Iron;e&&(null!==e.Iron?t/=e.Iron.priority:t=0),d.push(t)}if(t.hasOwnProperty("Steel")){u.push("Steel");let t=lt.smelterSettings.Steel;e&&(null!==e.Steel?t/=e.Steel.priority:t=0),d.push(t)}for(let e=0;e<d.length;e++)p+=d[e];for(let e=0;e<d.length;e++)h.push(d[e]/p);a=function(e,i){switch(u[e]){case"Iron":return!0;case"Steel":{let e=w.Coal.temp_rate>t.Steel.Coal,i=w.Iron.temp_rate>t.Steel.Iron;return e&&i}}return!1},t.Iron.num=0,t.Steel.num=0,s=function(e,i){switch(u[e]){case"Iron":w.Iron.temp_rate+=t.Steel.Iron*t.Steel.num,w.Iron.temp_rate/=1+t.Iron.percent*(i-1)/100,w.Iron.temp_rate*=1+t.Iron.percent*i/100,w.Iron.temp_rate-=t.Steel.Iron*t.Steel.num,t.Iron.num=i;break;case"Steel":w.Iron.temp_rate-=t.Steel.Iron,w.Coal.temp_rate-=t.Steel.Coal,t.Steel.num=i}};let m=ft(c.total,d,h,{requireFunc:a,allocFunc:s});console.log("SMELTER PRODUCE:",m);for(let e=0;e<n.length;e++)if(t[n[e]].num>c.alloc[e])for(let i=0;i<t[n[e]].num-c.alloc[e];i++)t[n[e]].decBtn.click();for(let e=0;e<n.length;e++)if(t[n[e]].num<c.alloc[e])for(let i=0;i<c.alloc[e]-t[n[e]].num;i++)t[n[e]].incBtn.click();for(let e=0;e<i;e++)t.Iron.btn.click();if(2==m.alloc.length)for(let e=0;e<m.alloc[1];e++)t.Steel.btn.click();t=null,await x()}async function nt(e){if(!y("tech-industrialization"))return;if(A["city-factory"].numTotal<1)return;if(!await _($("#city-factory > .special")))return;let t=A["city-factory"].numOn+A["space-red_factory"].numOn,i=function(){let e={},t=window.evolve.global.tech.factory?window.evolve.global.tech.factory:0;e.Lux={},e.Lux.decBtn=document.querySelector("#specialModal > div:nth-child(2) > span:nth-child(2)"),e.Lux.incBtn=document.querySelector("#specialModal > div:nth-child(2) > span:nth-child(4)");let i=document.querySelector("#specialModal > div:nth-child(2) > span:nth-child(1)").attributes["data-label"].value,n=/[^\d\.]+([\d\.]+)[^\d\.]+([\d\.]+)/.exec(i);e.Lux.num=window.evolve.global.city.factory.Lux,e.Lux.Furs=n[1],e.Lux.Money=n[2],e.Alloy={},e.Alloy.decBtn=document.querySelector("#specialModal > div:nth-child(3) > span:nth-child(2)"),e.Alloy.incBtn=document.querySelector("#specialModal > div:nth-child(3) > span:nth-child(4)"),i=document.querySelector("#specialModal > div:nth-child(3) > span:nth-child(1)").attributes["data-label"].value,n=/[^\d\.]+([\d\.]+)[^\d\.]+([\d\.]+)[^\d\.]+/.exec(i),e.Alloy.num=window.evolve.global.city.factory.Alloy,e.Alloy.Copper=n[1],e.Alloy.Aluminium=n[2];let o=et.Alloy.output[t];if(window.evolve.global.race.toxic&&(o*=1.2),window.evolve.global.tech.alloy&&(o*=1.37),window.evolve.global.race.metallurgist&&(o*=1+.04*window.evolve.global.race.metallurgist),o*=gt("Alloy")*gt("Global"),e.Alloy.produce=o,window.evolve.global.tech.polymer){e.Polymer={},e.Polymer.decBtn=document.querySelector("#specialModal > div:nth-child(4) > span:nth-child(2)"),e.Polymer.incBtn=document.querySelector("#specialModal > div:nth-child(4) > span:nth-child(4)");let i=document.querySelector("#specialModal > div:nth-child(4) > span:nth-child(1)").attributes["data-label"].value,n=/[^\d\.]+([\d\.]+)[^\d\.]+([\d\.]+)?[^\d\.]+/.exec(i);e.Polymer.num=window.evolve.global.city.factory.Polymer,e.Polymer.Oil=n[1],e.Polymer.Lumber=n[2]?n[2]:0;let o=et.Polymer.output[t];window.evolve.global.race.toxic&&(o*=1.2),window.evolve.global.tech.polymer>=2&&(o*=1.42),o*=gt("Polymer")*gt("Global"),e.Polymer.produce=o}if(window.evolve.global.tech.nano){e.Nano={},e.Nano.decBtn=document.querySelector("#specialModal > div:nth-child(5) > span:nth-child(2)"),e.Nano.incBtn=document.querySelector("#specialModal > div:nth-child(5) > span:nth-child(4)");let i=document.querySelector("#specialModal > div:nth-child(5) > span:nth-child(1)").attributes["data-label"].value,n=/[^\d\.]+([\d\.]+)[^\d\.]+([\d\.]+)[^\d\.]+/.exec(i);e.Nano.num=window.evolve.global.city.factory.Nano,e.Nano.Coal=n[1],e.Nano.Neutronium=n[2],e.Nano.produce=0;let o=et.Nano_Tube.output[t];window.evolve.global.race.toxic&&(o*=1.08),window.evolve.global.tech.polymer>=2&&(o*=1.42),o*=gt("Nano_Tube")*gt("Global"),e.Nano.produce=o}if(window.evolve.global.tech.stanene){e.Stanene={},e.Stanene.decBtn=document.querySelector("#specialModal > div:nth-child(6) > span:nth-child(2)"),e.Stanene.incBtn=document.querySelector("#specialModal > div:nth-child(6) > span:nth-child(4)");let i=document.querySelector("#specialModal > div:nth-child(6) > span:nth-child(1)").attributes["data-label"].value,n=/[^\d\.]+([\d\.]+)[^\d\.]+([\d\.]+)[^\d\.]+/.exec(i);e.Stanene.num=window.evolve.global.city.factory.Stanene,e.Stanene.Aluminium=n[1],e.Stanene.Nano_Tube=n[2];let o=et.Stanene.output[t];o*=gt("Stanene")*gt("Global"),e.Stanene.produce=o}return e}();console.log("FACTORY DATA:",i),i.Lux&&(w.Furs.temp_rate+=i.Lux.Furs*i.Lux.num,w.Money.temp_rate+=i.Lux.Money*i.Lux.num),i.Alloy&&(w.Copper.temp_rate+=i.Alloy.Copper*i.Alloy.num,w.Aluminium.temp_rate+=i.Alloy.Aluminium*i.Alloy.num,w.Alloy.temp_rate-=i.Alloy.produce*i.Alloy.num),i.Polymer&&(w.Lumber.temp_rate+=i.Polymer.Lumber*i.Polymer.num,w.Oil.temp_rate+=i.Polymer.Oil*i.Polymer.num,w.Polymer.temp_rate-=i.Polymer.produce*i.Polymer.num),i.Nano&&(w.Coal.temp_rate+=i.Nano.Coal*i.Nano.num,w.Neutronium.temp_rate+=i.Nano.Neutronium*i.Nano.num,w.Nano_Tube.temp_rate-=i.Nano.produce*i.Nano.num),i.Stanene&&(w.Aluminium.temp_rate+=i.Stanene.Aluminium*i.Stanene.num,w.Nano_Tube.temp_rate+=i.Stanene.Nano_Tube*i.Stanene.num,w.Stanene.temp_rate-=i.Stanene.produce*i.Stanene.num);let n=[],o=[],r=0,l=[];if(i.hasOwnProperty("Lux")){n.push("Lux");let t=lt.factorySettings.Luxury_Goods;e&&(null!==e.Money?t*=e.Money.priority:t/=1e11),o.push(t),r+=t}if(i.hasOwnProperty("Alloy")){n.push("Alloy");let t=lt.factorySettings.Alloy;e&&(null!==e.Alloy?t*=e.Alloy.priority:t/=1e11),o.push(t),r+=t}if(i.hasOwnProperty("Polymer")){n.push("Polymer");let t=lt.factorySettings.Polymer;e&&(null!==e.Polymer?t*=e.Polymer.priority:t/=1e11),o.push(t),r+=t}if(i.hasOwnProperty("Nano")){n.push("Nano");let t=lt.factorySettings.Nano_Tube;e&&(null!==e.Nano_Tube?t*=e.Nano_Tube.priority:t/=1e11),o.push(t),r+=t}if(i.hasOwnProperty("Stanene")){n.push("Stanene");let t=lt.factorySettings.Stanene;e&&(null!==e.Stanene?t*=e.Stanene.priority:t/=1e11),o.push(t),r+=t}for(let e=0;e<o.length;e++)l[e]=o[e]/r;let a=ft(t,o,l,{requireFunc:function(e,t){switch(n[e]){case"Lux":return w.Furs.temp_rate>i.Lux.Furs;case"Alloy":{let e=w.Copper.temp_rate>i.Alloy.Copper,t=w.Aluminium.temp_rate>i.Alloy.Aluminium;return e&&t}case"Polymer":{let e=w.Lumber.temp_rate>i.Polymer.Lumber,t=w.Oil.temp_rate>i.Polymer.Oil;return e&&t}case"Nano":{let e=w.Coal.temp_rate>i.Nano.Coal,t=w.Neutronium.temp_rate>i.Nano.Neutronium;return e&&t}case"Stanene":{let e=w.Aluminium.temp_rate>i.Stanene.Aluminium,t=w.Nano_Tube.temp_rate>i.Stanene.Nano_Tube;return e&&t}}return!1},allocFunc:function(e,t){switch(n[e]){case"Lux":w.Furs.temp_rate-=i.Lux.Furs,w.Money.temp_rate+=i.Lux.Money;break;case"Alloy":w.Copper.temp_rate-=i.Alloy.Copper,w.Aluminium.temp_rate-=i.Alloy.Aluminium,w.Alloy.temp_rate+=i.Alloy.produce;break;case"Polymer":w.Lumber.temp_rate-=i.Polymer.Lumber,w.Oil.temp_rate-=i.Polymer.Oil,w.Polymer.temp_rate+=i.Polymer.produce;break;case"Nano":w.Coal.temp_rate-=i.Nano.Coal,w.Neutronium.temp_rate-=i.Nano.Neutronium,w.Nano_Tube.temp_rate+=i.Nano.produce;break;case"Stanene":w.Aluminium.temp_rate-=i.Stanene.Aluminium,w.Nano_Tube.temp_rate-=i.Stanene.Nano_Tube,w.Stanene.temp_rate+=i.Stanene.produce}}});console.log("FACTORY PRIO:",o,"FACTORY RATIO:",l),console.log("FACTORY ALLOC:",a);for(let e=0;e<n.length;e++)if(i[n[e]].num>a.alloc[e])for(let t=0;t<i[n[e]].num-a.alloc[e];t++)i[n[e]].decBtn.click();for(let e=0;e<n.length;e++)if(i[n[e]].num<a.alloc[e])for(let t=0;t<a.alloc[e]-i[n[e]].num;t++)i[n[e]].incBtn.click();i=null,await x()}async function ot(e){if(window.evolve.global.tech.alpha<2)return;if(A["interstellar-mining_droid"].numTotal<1)return;if(!await _($("#interstellar-mining_droid > .special")))return;let t=A["interstellar-mining_droid"].numOn,i=function(){let e={Adamantite:{}};return e.Adamantite.produce=.075*tt(),e.Adamantite.num=window.evolve.global.interstellar.mining_droid.adam,e.Adamantite.decBtn=document.querySelector("#specialModal > div:nth-child(2) > span:nth-child(2)"),e.Adamantite.incBtn=document.querySelector("#specialModal > div:nth-child(2) > span:nth-child(4)"),e.Uranium={},e.Uranium.produce=.12*tt(),e.Uranium.num=window.evolve.global.interstellar.mining_droid.uran,e.Uranium.decBtn=document.querySelector("#specialModal > div:nth-child(3) > span:nth-child(2)"),e.Uranium.incBtn=document.querySelector("#specialModal > div:nth-child(3) > span:nth-child(4)"),e.Coal={},e.Coal.produce=3.75*tt(),e.Coal.num=window.evolve.global.interstellar.mining_droid.coal,e.Coal.decBtn=document.querySelector("#specialModal > div:nth-child(4) > span:nth-child(2)"),e.Coal.incBtn=document.querySelector("#specialModal > div:nth-child(4) > span:nth-child(4)"),e.Aluminium={},e.Aluminium.produce=2.75*tt(),e.Aluminium.num=window.evolve.global.interstellar.mining_droid.alum,e.Aluminium.decBtn=document.querySelector("#specialModal > div:nth-child(5) > span:nth-child(2)"),e.Aluminium.incBtn=document.querySelector("#specialModal > div:nth-child(5) > span:nth-child(4)"),e}();console.log("DROID DATA:",i),w.Adamantite.temp_rate-=i.Adamantite.produce*i.Adamantite.num,w.Uranium.temp_rate-=i.Uranium.produce*i.Uranium.num,w.Coal.temp_rate-=i.Coal.produce*i.Coal.num,w.Aluminium.temp_rate-=i.Aluminium.produce*i.Aluminium.num;let n=[],o=[],r=0,l=[];if(i.hasOwnProperty("Adamantite")){n.push("Adamantite");let t=lt.droidSettings.Adamantite;e&&(null!==e.Adamantite?t*=e.Adamantite.priority:t/=1e11),o.push(t),r+=t}if(i.hasOwnProperty("Uranium")){n.push("Uranium");let t=lt.droidSettings.Uranium;e&&(null!==e.Uranium?t*=e.Uranium.priority:t/=1e11),o.push(t),r+=t}if(i.hasOwnProperty("Coal")){n.push("Coal");let t=lt.droidSettings.Coal;e&&(null!==e.Coal?t*=e.Coal.priority:t/=1e11),o.push(t),r+=t}if(i.hasOwnProperty("Aluminium")){n.push("Aluminium");let t=lt.droidSettings.Aluminium;e&&(null!==e.Aluminium?t*=e.Aluminium.priority:t/=1e11),o.push(t),r+=t}for(let e=0;e<o.length;e++)l[e]=o[e]/r;let a=ft(t,o,l,{allocFunc:function(e,t){switch(n[e]){case"Adamantite":w.Adamantite.temp_rate+=i.Adamantite.produce;break;case"Uranium":w.Uranium.temp_rate+=i.Uranium.produce;break;case"Coal":w.Coal.temp_rate+=i.Coal.produce;break;case"Aluminium":w.Aluminium.temp_rate+=i.Aluminium.produce}}});console.log("DROID PRIO:",o,"DROID RATIO:",l),console.log("DROID ALLOC:",a);for(let e=0;e<n.length;e++)if(i[n[e]].num>a.alloc[e])for(let t=0;t<i[n[e]].num-a.alloc[e];t++)i[n[e]].decBtn.click();for(let e=0;e<n.length;e++)if(i[n[e]].num<a.alloc[e])for(let t=0;t<a.alloc[e]-i[n[e]].num;t++)i[n[e]].incBtn.click();i=null,await x()}async function rt(e){if(!y("tech-graphene"))return;if(!await _($("#interstellar-g_factory > .special")))return;let t=function(){let e={},t=$("#specialModal > div:nth-child(2) > span");if(!window.evolve.global.race.kindling_kindred){e.Lumber={},e.Lumber.decBtn=t[0],e.Lumber.incBtn=t[2];let i=t[1].attributes["data-label"].value;e.Lumber.fuel=parseFloat(/Consume ([\d\.]+).*/.exec(i)[1]),e.Lumber.num=window.evolve.global.interstellar.g_factory.Lumber}if(window.evolve.global.resource.Coal.display){e.Coal={},e.Coal.decBtn=e.Lumber?t[3]:t[0],e.Coal.incBtn=e.Lumber?t[5]:t[2];let i=e.Lumber?t[4].attributes["data-label"].value:t[1].attributes["data-label"].value;e.Coal.fuel=parseFloat(/Consume ([\d\.]+).*/.exec(i)[1]),e.Coal.num=window.evolve.global.interstellar.g_factory.Coal}if(window.evolve.global.resource.Oil.display){e.Oil={},e.Oil.decBtn=e.Lumber?t[6]:t[3],e.Oil.incBtn=e.Lumber?t[8]:t[5];let i=e.Lumber?t[7].attributes["data-label"].value:t[4].attributes["data-label"].value;e.Oil.fuel=parseFloat(/Consume ([\d\.]+).*/.exec(i)[1]),e.Oil.num=window.evolve.global.interstellar.g_factory.Oil}return e}();console.log("GRAPHENE Data:",t);let i=A["interstellar-g_factory"].numOn;t.hasOwnProperty("Lumber")&&(w.Lumber.temp_rate+=t.Lumber.fuel*t.Lumber.num),t.hasOwnProperty("Coal")&&(w.Coal.temp_rate+=t.Coal.fuel*t.Coal.num),t.hasOwnProperty("Oil")&&(w.Oil.temp_rate+=t.Oil.fuel*t.Oil.num);let n=[],o=[],r=0,l=[];if(t.hasOwnProperty("Lumber")){n.push("Lumber");let t=lt.grapheneSettings.Wood;e&&(null!==e.Lumber?t/=e.Lumber.priority:t*=1e11),o.push(t)}if(t.hasOwnProperty("Coal")){n.push("Coal");let t=lt.grapheneSettings.Coal;e&&(null!==e.Coal?t/=e.Coal.priority:t*=1e11),o.push(t)}if(t.hasOwnProperty("Oil")){n.push("Oil");let t=lt.grapheneSettings.Oil;e&&(null!==e.Oil?t/=e.Oil.priority:t*=1e11),o.push(t)}for(let e=0;e<o.length;e++)r+=o[e];for(let e=0;e<o.length;e++)l.push(o[e]/r);let a=ft(i,o,l,{requireFunc:function(e,i){switch(n[e]){case"Lumber":return w.Lumber.temp_rate>t.Lumber.fuel;case"Coal":return w.Coal.temp_rate>t.Coal.fuel;case"Oil":return w.Oil.temp_rate>t.Oil.fuel}return!1},allocFunc:function(e,i){switch(n[e]){case"Lumber":w.Lumber.temp_rate-=t.Lumber.fuel;break;case"Coal":w.Coal.temp_rate-=t.Coal.fuel;break;case"Oil":w.Oil.temp_rate-=t.Oil.fuel}}});console.log("GRAPHENE PRIO:",o),console.log("GRAPHENE FUEL:",a);for(let e=0;e<n.length;e++)if(t[n[e]].num>a.alloc[e])for(let i=0;i<t[n[e]].num-a.alloc[e];i++)t[n[e]].decBtn.click();for(let e=0;e<n.length;e++)if(t[n[e]].num<a.alloc[e])for(let i=0;i<a.alloc[e]-t[n[e]].num;i++)t[n[e]].incBtn.click();t=null,await x()}var lt={};function at(){console.log("Loading Settings");let e=localStorage.getItem("settings");null!=e&&(lt=JSON.parse(e));try{Ze()}catch(e){console.log("Error: Load Evolution",e)}try{c()}catch(e){console.log("Error: Load Farm",e)}try{lt.hasOwnProperty("resources")||(lt.resources={}),Object.keys(window.evolve.global.resource).forEach((function(e){void 0!==window.evolve.craftCost[e]?w[e]=new b(e):void 0!==window.evolve.global.resource[e].trade?w[e]=new f(e):w[e]=new v(e)}))}catch(e){console.log("Error: Load Resources",e)}try{lt.hasOwnProperty("actions")||(lt.actions={}),Q.Crate=new J("Crate",w.Lumber.unlocked?{Plywood:100}:{Stone:2e3}),Q.Container=new J("Container",{Steel:1250})}catch(e){console.log("Error: Load Storage",e)}try{lt.hasOwnProperty("actions")||(lt.actions={}),te.Gene=new Y("Gene"),te.Mercenary=new X("Mercenary"),te.FortressMercenary=new Z("FortressMercenary"),te.Sacrifice=new ee("Sacrifice")}catch(e){console.log("Error: Load Misc Actions",e)}try{!function(){lt.hasOwnProperty("actions")||(lt.actions={});for(let e in window.evolve.actions.tech){if("exotic_infusion"==e||"infusion_check"==e||"infusion_confirm"==e)continue;let t=window.evolve.actions.tech[e].id;m[t]=new h(t,["tech",e])}}()}catch(e){console.log("Error: Load Researches",e)}try{!function(){lt.hasOwnProperty("actions")||(lt.actions={});for(let e in window.evolve.actions.city){if("food"==e||"lumber"==e||"stone"==e||"slaughter"==e)continue;let t=window.evolve.actions.city[e].id;t in S?A[t]=new O(t,["city",e]):A[t]=new C(t,["city",e])}for(let e in window.evolve.actions.space)for(let t in window.evolve.actions.space[e]){if("info"==t)continue;let i=window.evolve.actions.space[e][t].id;i in S?A[i]=new O(i,["space",e,t]):A[i]=new C(i,["space",e,t])}for(let e in window.evolve.actions.starDock){if("prep_ship"==e||"launch_ship"==e)continue;let t=window.evolve.actions.starDock[e].id;A[t]=new M(t,["starDock",e])}for(let e in window.evolve.actions.interstellar)for(let t in window.evolve.actions.interstellar[e]){if("info"==t)continue;let i=window.evolve.actions.interstellar[e][t].id;i in S?A[i]=new O(i,["interstellar",e,t]):A[i]=new C(i,["interstellar",e,t])}for(let e in window.evolve.actions.portal)for(let t in window.evolve.actions.portal[e]){if("info"==t)continue;let i=window.evolve.actions.portal[e][t].id;i in S?A[i]=new O(i,["portal",e,t]):A[i]=new C(i,["portal",e,t])}console.log(A)}()}catch(e){console.log("Error: Load Buildings",e)}try{!async function(){if(A["space-star_dock"].numTotal<1)return;if(!await _($("#space-star_dock > .special")))return!1;A["spcdock-probes"].num=A["spcdock-probes"].numTotal,A["spcdock-probes"].loadRes(),A["spcdock-seeder"].num=A["spcdock-seeder"].numTotal,A["spcdock-seeder"].loadRes(),await x()}()}catch(e){console.log("Error: Load SpaceDock Buildings",e)}try{!function(){for(var e in lt.hasOwnProperty("jobs")||(lt.jobs={}),re.free=new ne("free",0),window.evolve.global.civic)window.evolve.global.civic[e].hasOwnProperty("job")&&(re[e]="craftsman"==e?new oe(e,0):new ie(e,0))}()}catch(e){console.log("Error: Load Jobs",e)}try{lt.hasOwnProperty("jobs")||(lt.jobs={}),Object.keys(window.evolve.global.resource).forEach((function(e){void 0!==window.evolve.craftCost[e]&&(ae[e]=new le(e,5))}))}catch(e){console.log("Error: Load Craft Jobs",e)}try{lt.hasOwnProperty("actions")||(lt.actions={}),z.lhc=new H("lhc",{Money:25e5,Knowledge:5e5,Copper:125e3,Cement:25e4,Steel:187500,Titanium:5e4,Polymer:12e3}),z.stock_exchange=new H("stock_exchange",{Money:3e6,Plywood:25e3,Brick:2e4,Wrought_Iron:1e4}),z.launch_facility=new H("launch_facility",{Money:2e6,Knowledge:5e5,Cement:15e4,Oil:2e4,Sheet_Metal:15e3,Alloy:25e3}),z.monument=new K("monument"),V()}catch(e){console.log("Error: Load ARPAs",e)}lt.hasOwnProperty("smelterSettings")||(lt.smelterSettings={}),lt.smelterSettings.hasOwnProperty("Interval")||(lt.smelterSettings.Interval=10),lt.smelterSettings.hasOwnProperty("pqCheck")||(lt.smelterSettings.pqCheck=!0),lt.smelterSettings.hasOwnProperty("Wood")||(lt.smelterSettings.Wood=1),lt.smelterSettings.hasOwnProperty("Coal")||(lt.smelterSettings.Coal=1),lt.smelterSettings.hasOwnProperty("Oil")||(lt.smelterSettings.Oil=1),lt.smelterSettings.hasOwnProperty("Iron")||(lt.smelterSettings.Iron=2),lt.smelterSettings.hasOwnProperty("Steel")||(lt.smelterSettings.Steel=3),lt.hasOwnProperty("factorySettings")||(lt.factorySettings={}),lt.factorySettings.hasOwnProperty("Interval")||(lt.factorySettings.Interval=11),lt.factorySettings.hasOwnProperty("pqCheck")||(lt.factorySettings.pqCheck=!0),lt.factorySettings.hasOwnProperty("Luxury_Goods")||(lt.factorySettings.Luxury_Goods=0),lt.factorySettings.hasOwnProperty("Alloy")||(lt.factorySettings.Alloy=3),lt.factorySettings.hasOwnProperty("Polymer")||(lt.factorySettings.Polymer=3),lt.factorySettings.hasOwnProperty("Nano_Tube")||(lt.factorySettings.Nano_Tube=7),lt.factorySettings.hasOwnProperty("Stanene")||(lt.factorySettings.Stanene=4),lt.hasOwnProperty("droidSettings")||(lt.droidSettings={}),lt.droidSettings.hasOwnProperty("Interval")||(lt.droidSettings.Interval=13),lt.droidSettings.hasOwnProperty("pqCheck")||(lt.droidSettings.pqCheck=!0),lt.droidSettings.hasOwnProperty("Adamantite")||(lt.droidSettings.Adamantite=10),lt.droidSettings.hasOwnProperty("Uranium")||(lt.droidSettings.Uranium=0),lt.droidSettings.hasOwnProperty("Coal")||(lt.droidSettings.Coal=0),lt.droidSettings.hasOwnProperty("Aluminium")||(lt.droidSettings.Aluminium=0),lt.hasOwnProperty("grapheneSettings")||(lt.grapheneSettings={}),lt.grapheneSettings.hasOwnProperty("Interval")||(lt.grapheneSettings.Interval=17),lt.grapheneSettings.hasOwnProperty("pqCheck")||(lt.grapheneSettings.pqCheck=!0),lt.grapheneSettings.hasOwnProperty("Wood")||(lt.grapheneSettings.Wood=0),lt.grapheneSettings.hasOwnProperty("Coal")||(lt.grapheneSettings.Coal=10),lt.grapheneSettings.hasOwnProperty("Oil")||(lt.grapheneSettings.Oil=5),lt.hasOwnProperty("supportSettings")||(lt.supportSettings={}),lt.supportSettings.hasOwnProperty("Interval")||(lt.supportSettings.Interval=23),lt.hasOwnProperty("autoPrint")||(lt.autoPrint=!0),lt.hasOwnProperty("printSettings")||(lt.printSettings={});for(let e=0;e<st.length;e++)lt.hasOwnProperty(st[e])||(lt.printSettings[st[e]]=!0);lt.hasOwnProperty("autoFarm")||(lt.autoFarm=!1),lt.hasOwnProperty("farmRate")||(lt.farmRate=10),lt.hasOwnProperty("autoRefresh")||(lt.autoRefresh=!1),lt.hasOwnProperty("autoPrestige")||(lt.autoPrestige=!1),lt.hasOwnProperty("prestige")||(lt.prestige="mad"),lt.hasOwnProperty("autoEvolution")||(lt.autoEvolution=!1);for(let e=0;e<ze.length;e++)lt.hasOwnProperty(ze[e])||(lt[ze[e]]=!1);lt.hasOwnProperty("evolution")||(lt.evolution="antid"),lt.hasOwnProperty("autoTax")||(lt.autoTax=!1),lt.hasOwnProperty("minimumMorale")||(lt.minimumMorale=100),lt.hasOwnProperty("autoEmploy")||(lt.autoEmploy=!1),lt.hasOwnProperty("autoBattle")||(lt.autoBattle=!1),lt.hasOwnProperty("minWinRate")||(lt.minWinRate=60),lt.hasOwnProperty("maxCampaign")||(lt.maxCampaign=4),lt.hasOwnProperty("woundedCheck")||(lt.woundedCheck=!1),lt.hasOwnProperty("campaignFailCheck")||(lt.campaignFailCheck=!1),lt.hasOwnProperty("campaignFailInterval")||(lt.campaignFailInterval=5),lt.hasOwnProperty("autoFortress")||(lt.autoFortress=!1),lt.hasOwnProperty("autoCraft")||(lt.autoCraft=!1),lt.hasOwnProperty("autoMarket")||(lt.autoMarket=!1),lt.hasOwnProperty("marketVolume")||(lt.marketVolume=1),lt.hasOwnProperty("minimumMoney")||(lt.minimumMoney=0),lt.hasOwnProperty("autoTrade")||(lt.autoTrade=!1),lt.hasOwnProperty("autoStorage")||(lt.autoStorage=!1),lt.hasOwnProperty("autoEjector")||(lt.autoEjector=!1),lt.hasOwnProperty("autoSupport")||(lt.autoSupport=!1),lt.hasOwnProperty("autoSmelter")||(lt.autoSmelter=!1),lt.hasOwnProperty("autoFactory")||(lt.autoFactory=!1),lt.hasOwnProperty("autoDroid")||(lt.autoDroid=!1),lt.hasOwnProperty("autoGraphene")||(lt.autoGraphene=!1),lt.hasOwnProperty("autoResearch")||(lt.autoResearch=!1),lt.hasOwnProperty("religion1")||(lt.religion1="fanaticism"),lt.hasOwnProperty("religion2")||(lt.religion2="study"),lt.hasOwnProperty("unify")||(lt.unify="unify"),lt.hasOwnProperty("autoPriority")||(lt.autoPriority=!1),lt.hasOwnProperty("showAll")||(lt.showAll=!1),lt.hasOwnProperty("showBuilding")||(lt.showBuilding=!1),lt.hasOwnProperty("showResearch")||(lt.showResearch=!1),lt.hasOwnProperty("showMisc")||(lt.showMisc=!1),lt.hasOwnProperty("log")||(lt.log=[])}const st=["Buildings","Researches","Misc"];function ct(){localStorage.setItem("settings",JSON.stringify(lt))}let ut=null;let dt=!1;function pt(e){e=void 0===e?1:e;let t=$("#tax_rates > .sub");St();for(let i=0;i<e;i++)t.click()}function ht(e){e=void 0===e?1:e;let t=$("#tax_rates > .add");St();for(let i=0;i<e;i++)t.click()}function mt(e){if(!y("tech-tax_rates"))return;let t=function(){let e=100;for(var t in window.evolve.global.city.morale)"current"!=t&&(e+=window.evolve.global.city.morale[t]);return e}(),i=function(){let e=100;return e+=A["city-amphitheatre"].numTotal,e+=A["city-casino"].numTotal,e+=2*A["space-vr_center"].numOn,y("tech-superstars")&&(e+=window.evolve.global.civic.entertainer.workers),e+=2*z.monument.numTotal,window.evolve.global.civic.taxes.tax_rate<20&&(e+=10-Math.floor(window.evolve.global.civic.taxes.tax_rate/2)),e}(),n=w.Money.temp_rate||w.Money.rate;1==w.Money.ratio||(t>=i?ht(t-i):t<=lt.minimumMorale?pt(lt.minimumMorale-t):w.Money.ratio<.99||n<0?ht():pt())}function yt(e){return new Promise(t=>setTimeout(t,e))}function gt(e){let t=1;for(let i in window.evolve.breakdown.p[e]){let n=window.evolve.breakdown.p[e][i];"%"==n[n.length-1]&&(t*=+n.substring(0,n.length-1)/100+1)}return t}function vt(e,t){return t.priority-e.priority}function ft(e,t,i,n){n=n||{};let o=[],r=[],l=0;for(let e=0;e<t.length;e++)r.push(0);for(let a=0;a<e;a++){let e=a+1,s=null,c=null;for(let o=0;o<t.length;o++){if(0==t[o]||0==i[o])continue;if(n.hasOwnProperty("max")&&-1!=n.max[o]&&r[o]>=n.max[o])continue;if(n.hasOwnProperty("requireFunc")&&!n.requireFunc(o,r[o]))continue;if(n.hasOwnProperty("min")&&r[o]<n.min[o]){c=o;break}let l=((r[o]+1)/e-i[o])**2;1!=e&&(l-=(r[o]/(e-1)-i[o])**2),(null===s||l<s)&&(s=l,c=o)}if(null===c)break;o[a]=c,r[c]+=1,l+=1,n.hasOwnProperty("allocFunc")&&n.allocFunc(c,r[c])}return{seq:o,alloc:r,total:l}}function wt(e,t){t=t||"warning";var i=$('<p class="has-text-'+t+'">'+e+"</p>");$("#autolog").prepend(i),$("#autolog").children().length>30&&$("#autolog").children().last().remove()}function bt(){try{let e=$("#statsPanel")[0].children[$("#statsPanel")[0].children.length-1].innerText,t=/Game Days Played: ([\d]+)/.exec(e);return parseInt(t[1])}catch(e){return console.log("Error in getting total game days"),null}}function St(){var e=new KeyboardEvent("keyup",{ctrlKey:!1,shiftKey:!1,altKey:!1});document.dispatchEvent(e)}function Pt(e){let t=1;return t*=e.ctrlKey?10:1,t*=e.shiftKey?25:1,t*=e.altKey?100:1}function kt(e){var t={K:1e3,M:1e6},i=/([-]?)([\.0-9]+)([^\d\.])/.exec(e);if(null!==i&&4==i.length){var n="-"==i[1]?-1:1,o=parseFloat(i[2]),r=i[3];return null!==t[r]&&(o*=t[r]),o*=n}return parseFloat(e)}function _t(){return"protoplasm"==window.evolve.global.race.species}function xt(e){let t=$(".achievement");for(let i=0;i<t.length;i++)if(t[i].children[0].innerText==e)return $(".achievement")[0].children[2].children[0].attributes.class.value[4];return-1}function $t(){return lt.minimumMoney<1?lt.minimumMoney*resources.Money.storage:lt.minimumMoney}function Ct(e,t,i){let n=Math.exp(-.25*t);if(null!=i&&(i instanceof h&&(n/=50),i instanceof C&&i.softCap>=0)){n*=1+Math.exp(.75*(i.numTotal-i.softCap))}return e*n}function Ot(){let e=function(){let e=[];for(var t in A){if(!A[t].unlocked)continue;if(!A[t].enabled)continue;if(-1!=A[t].limit&&A[t].numTotal>=A[t].limit)continue;let i=document.getElementById(A[t].id);null!==i?i.className.indexOf("cnam")>=0||e.push(A[t]):"spcdock-probes"!=t&&"spcdock-seeder"!=t||e.push(A[t])}return e}().concat(function(){let e=[];for(var t in m){if(!m[t].unlocked)continue;if(!m[t].enabled)continue;if(m[t].researched)continue;let i=document.getElementById(m[t].id);if(null!==i&&!(i.className.indexOf("cnam")>=0)){if(lt.autoResearch){if("tech-fanaticism"==m[t].id&&"anthropology"==lt.religion1)continue;if("tech-anthropology"==m[t].id&&"fanaticism"==lt.religion1)continue;if("tech-study"==m[t].id&&"deify"==lt.religion2)continue;if("tech-deify"==m[t].id&&"study"==lt.religion2)continue;if(m[t].id.indexOf("wc")>=0)if("unify"==lt.uniChoice){if("tech-wc_reject"==m[t].id)continue}else if("tech-wc_conquest"==m[t].id||"tech-wc_morale"==m[t].id||"tech-wc_money"==m[t].id)continue}e.push(m[t])}}return e}()).concat(function(){let e=[];for(var t in z)z[t].unlocked&&z[t].enabled&&(-1!=z[t].limit&&z[t].numTotal>=z[t].limit||e.push(z[t]));return e}()).concat(function(){let e=[];for(var t in Q)Q[t].unlocked&&Q[t].enabled&&(Q[t].full||e.push(Q[t]));return e}()).concat(function(){let e=[];for(var t in te)te[t].unlocked&&te[t].enabled&&e.push(te[t]);return e}());for(let t=0;t<e.length;t++)e[t].completion={},e[t].completionTime={},e[t].maxCompletionTime=0,e[t].limitingRes=null,e[t].keptRes={};return e}async function Mt(e){let t=Ot();for(let e in w)w[e].temp_rate=w[e].rate;if(y("tech-trade"))for(let e in w){let t=w[e];t instanceof f&&(t.tradeNum<0?(w.Money.temp_rate-=t.tradeSellCost*-t.tradeNum,t.temp_rate+=t.tradeAmount*-t.tradeNum):(w.Money.temp_rate+=t.tradeBuyCost*t.tradeNum,t.temp_rate-=t.tradeAmount*t.tradeNum))}if(window.evolve.global.interstellar.hasOwnProperty("mass_ejector")&&window.evolve.global.interstellar.mass_ejector.on>0)for(let e in w){let t=w[e];t.ejectable&&(t.temp_rate+=window.evolve.global.interstellar.mass_ejector[e])}let i=function(){let e=[];for(var t in w)w[t].unlocked&&e.push(w[t]);return e}(),n={},o={};for(let e=0;e<i.length;e++){let o=i[e],r=[];for(let e=0;e<t.length;e++){let i=t[e].getResDep(o.id);null!==i&&NaN!==i&&i>0&&(r.push(t[e]),t[e].completion[o.id.toLowerCase()]=!1)}r.sort((function(e,t){return Ct(e.getResDep(o.id),e.priority,e)-Ct(t.getResDep(o.id),t.priority,t)}));for(let e=0;e<r.length;e++){let t=r[e];if(o.amount>=t.getResDep(o.id))t.completionTime[o.id]=0;else{let e=(t.getResDep(o.id)-o.amount)/o.temp_rate;e=e<0?1:e,t.completionTime[o.id]=e,e>t.maxCompletionTime&&(t.maxCompletionTime=e,t.limitingRes=o.id)}}n[o.id]=r}for(let e=0;e<i.length;e++){let t=i[e],r=n[t.id];if(o[t.id]=null,!(t instanceof b)&&t.ratio>.99)for(let e=0;e<r.length;e++)r[e].completion[t.id.toLowerCase()]=!0;else{let i=t.amount;for(let n=0;n<r.length;n++){let l=r[n];if(!(l.getResDep(t.id)<=i)){o[t.id]=l;break}if(l.completion[t.id.toLowerCase()]=!0,l.limitingRes==t.id)l.keptRes[t.id]=l.getResDep(t.id),i-=l.keptRes[t.id];else{let n=1/(1+Math.exp(-.1*l.priority)),o=Math.exp(-.005*l.maxCompletionTime);l.keptRes[t.id]=n*o*l.getResDep(t.id)/(e+1),i-=l.keptRes[t.id]}}}}t.sort(vt),console.log("ACT:",t);for(let e=0;e<t.length;e++){let i=t[e],n=!0;for(let e in i.completion)if(!i.completion[e]){n=!1;break}if(n){console.log(i.id,"can buy");let e=i.click();if("tech-wc_conquest"!=i.id&&"tech-wc_morale"!=i.id&&"tech-wc_money"!=i.id&&"tech-wc_reject"!=i.id||(e=!1),e){lt.autoPrint&&(i instanceof C&&!(i instanceof H)?lt.printSettings.Buildings&&wt(bt().toString()+" [AUTO-PRIORITY] "+i.name,"warning"):i instanceof h?lt.printSettings.Researches&&wt(bt().toString()+" [AUTO-PRIORITY] "+i.name,"warning"):lt.printSettings.Misc&&wt(bt().toString()+" [AUTO-PRIORITY] "+i.name,"warning")),de(i);break}}}return lt.autoSmelter&&e%lt.smelterSettings.Interval==0&&(lt.smelterSettings.pqCheck?await it(o):await it()),lt.autoFactory&&e%lt.factorySettings.Interval==0&&(lt.factorySettings.pqCheck?await nt(o):await nt()),lt.autoDroid&&e%lt.droidSettings.Interval==0&&(lt.droidSettings.pqCheck?await ot(o):await ot()),lt.autoGraphene&&e%lt.grapheneSettings.Interval==0&&(lt.grapheneSettings.pqCheck?await rt(o):await rt()),lt.autoSupport&&e%lt.supportSettings.Interval==0&&await P(),console.log("LIM:",o),console.log("PQ:",n),{limits:o,PQs:n}}i.d(t,"url",(function(){return At})),i.d(t,"version",(function(){return Rt}));const At="https://github.com/HLXII/Evolve-Autoscript",Rt="1.2.12";async function It(e){if(console.clear(),console.log(e),fe(),ct(),lt.autoFarm&&null===d?(console.log("Setting farm interval"),d=setInterval(u,lt.farmRate)):lt.autoFarm||null===d||(clearInterval(d),d=null),lt.autoRefresh&&null===ut?ut=setInterval((function(){location.reload()}),2e5):lt.autoRefresh||null===ut||(clearInterval(ut),ut=null),lt.autoBattle&&null===U?U=setInterval(W,25):lt.autoBattle||null===U||(clearInterval(U),U=null),_t())lt.autoEvolution&&(!function(){let e=document.querySelectorAll("#evolution .action"),t=null,i=0;for(let n=0;n<e.length;n++){let o=e[n];if(o.className.indexOf("cna")>=0)continue;if(Ke.includes(o.id))continue;if(o.id in Xe&&parseInt($("#"+o.id+" > a > .count")[0].innerText)>=Xe[o.id])continue;if(null!==/\w+\d+/.exec(o.id))continue;if(Qe.includes(o.id))continue;if(Ve.includes(o.id)&&!Ye[lt.evolution].includes(o.id))continue;let r=0;ze.includes(o.id)?Je.includes(o.id)&&"evo-junker"==o.id&&lt[o.id]?r=2:!o.classList.contains("hl")===lt[o.id]&&(r=10):Ve.includes(o.id)?(r=6,o.id==Ye[lt.evolution][Ye[lt.evolution].length-1]&&(r=5)):r="evo-sentience"==o.id?1:20,r>i&&(i=r,t=o)}null!==t&&(t.children[0].click(),i<=5&&(at(),we()))}(),loadFarm());else{var t=null;lt.autoPriority?t=await Mt(e):(lt.autoSmelter&&e%lt.smelterSettings.Interval==0&&await it(),lt.autoFactory&&e%lt.factorySettings.Interval==0&&await nt(),lt.autoDroid&&e%lt.droidSettings.Interval==0&&await ot(),lt.autoGraphene&&e%lt.grapheneSettings.Interval==0&&await rt(),lt.autoSupport&&e%lt.supportSettings.Interval==0&&await P()),lt.autoTrade&&function(e){if(!y("tech-trade"))return;if(null===e)return;let t=e.limits,i=(e.PQs,$("#tradeTotal").children()[0].innerText),n=parseInt(/Trade Routes [\d]+ \/ ([\d]+)/.exec(i)[1]),o=[];for(var r in w)w[r].unlocked&&w[r]instanceof f&&(w[r].ratio<.99||o.push(w[r]));o.sort((function(e,t){return t.tradeSellCost-e.tradeSellCost}));let l=[];for(let e=0;e<o.length;e++){let t=o[e],i=Math.floor(t.temp_rate/t.tradeAmount),r=i<n?i:n;for(let e=0;e<r;e++)l.push(t.id)}console.log("SELL SEQ:",l);let a=[];for(r in t)null!==t[r]&&r in w&&(w[r]instanceof f||"Money"==r)&&1!=t[r].completion[r]&&a.push({action:t[r],res:r});a.length>0&&a.sort((function(e,t){return vt(e.action,t.action)})),console.log("FOC LIST:",a);let s=[],c={},u={},d=0,p=[],h=[],m=[],g={};if(a.length>0){for(let e=0;e<a.length;e++)d+=(w[a[e].res].priority*a[e].action.priority)**2;for(let e=0;e<a.length;e++)c[a[e].res]=0,u[a[e].res]=(w[a[e].res].priority*a[e].action.priority)**2/d,u[a[e].res]*n<1&&(u[a[e].res]=0),"Money"!==a[e].res&&(p.push(w[a[e].res].priority),h.push(u[a[e].res]),m.push(a[e].res));g=ft(n,p,h)}s=g.seq;let v={},b={};for(let e in w)w[e]instanceof f&&(v[e]=0,b[e]=w[e].tradeNum);let S=0,P=0,k=n;for(u.Money>0&&(w.Money.temp_rate*=1-u.Money);k>0;)if(s&&s.length>S&&w.Money.temp_rate>w[m[s[S]]].tradeBuyCost)v[m[s[S]]]+=1,w[m[s[S]]].temp_rate+=w[m[s[S]]].tradeAmount,w.Money.temp_rate-=w[m[s[S]]].tradeBuyCost,k-=1,S+=1;else{if(P==l.length)break;v[l[P]]-=1,w[l[P]].temp_rate-=w[l[P]].tradeAmount,w.Money.temp_rate+=w[l[P]].tradeSellCost,k-=1,P+=1}console.log("OLD TRADE ROUTES:",b),console.log("NEW TRADE ROUTES:",v);for(let e in w)if(w[e]instanceof f)if(0==v[e])b[e]>0?(w[e].tradeDec(b[e]),b[e]=0):(w[e].tradeInc(-b[e]),b[e]=0);else if(Math.abs(v[e])<=Math.abs(b[e])){let t=v[e]-b[e];t<0?(w[e].tradeDec(-t),b[e]-=t):(w[e].tradeInc(t),b[e]+=t)}for(let e in w){if(!(w[e]instanceof f))continue;let t=v[e]-b[e];t<0?w[e].tradeDec(-t):w[e].tradeInc(t)}}(t),lt.autoEjector&&function(){if(!window.evolve.global.interstellar.hasOwnProperty("mass_ejector"))return;if(0==window.evolve.global.interstellar.mass_ejector.count)return;let e=1e3*window.evolve.global.interstellar.mass_ejector.on;if(0==e)return;let t=[];for(let e in w)w[e].ejectable&&t.push(w[e]);t.sort((function(e,t){return t.ejectMass-e.ejectMass})),console.log("SORTED:",t);let i=[];for(let n=0;n<t.length;n++){let o=t[n];if(1!=o.ratio&&!o.eject){i.push(0);continue}let r=Math.floor(o.temp_rate),l=r<e?r:e;i.push(l),e-=l}console.log("EJECTABLE:",t,i);for(let e=0;e<t.length;e++){let n=t[e];n.ejectRate>i[e]&&n.ejectDec(n.ejectRate-i[e])}for(let e=0;e<t.length;e++){let n=t[e];n.ejectRate<i[e]&&n.ejectInc(i[e]-n.ejectRate)}}(),lt.autoCraft&&function(){for(var e in w)w[e]instanceof b&&w[e].craft()}(),lt.autoEmploy&&function(e){let t=[];var i;let n=0,o=0,r=[],l=[],a=[];for(i in re)re[i].unlocked&&(t.push(re[i]),n+=re[i].employed,o+=re[i].priority,r.push(re[i].priority));for(let e=0;e<t.length;e++)l.push(t[e].priority/o),a.push(t[e].maxEmployed);let s=ft(n,r,l,{max:a});console.log("JOBS:",t,r,l,s.alloc),console.log(s.seq);for(let e=0;e<s.alloc.length;e++)t[e].employed>s.alloc[e]&&t[e].fire(t[e].employed-s.alloc[e]);for(let e=0;e<s.alloc.length;e++)t[e].employed<s.alloc[e]&&t[e].hire(s.alloc[e]-t[e].employed);re.craftsman.unlocked&&setTimeout((function(){let e=window.evolve.global.civic.craftsman.workers,t=0,n=[],o=[],r=[];for(i in ae)ae[i].unlocked&&(n.push(ae[i]),t+=ae[i].priority,o.push(ae[i].priority));for(let e=0;e<n.length;e++)r.push(n[e].priority/t);let l=ft(e,o,r);console.log("CRAFTJOBS:",n,o,r,l.alloc);for(let e=0;e<n.length;e++)l.alloc[e]<n[e].employed&&n[e].fire(n[e].employed-l.alloc[e]);for(let e=0;e<n.length;e++)l.alloc[e]>n[e].employed&&n[e].hire(l.alloc[e]-n[e].employed)}),50)}(),lt.autoTax&&mt(),lt.autoMarket&&function(){if(!y("tech-market"))return;let e=w.Money.amount,t=w.Money.storage,i=$("#market-qty").children();if(null==i||0==i.length)return;let n=Math.min(lt.marketVolume,i.length);i[n].click();let o=25;switch(n){case 1:o=10;break;case 2:o=25;break;case 3:o=100;break;case 4:o=250;break;case 5:o=1e3;break;case 6:o=2500;break;case 7:o=1e4;break;case 8:o=25e3}setTimeout((function(){for(var i in w){let n=w[i];if(!n.unlocked)continue;if(!(n instanceof f))continue;let r=n.amount,l=n.storage;if(n.autoSell&&n.ratio>n.sellRatio&&null!==n.sellBtn){let i=kt(n.sellBtn.innerHTML.substr(1)),a=0;for(;!(e+i>=t||r-o<=0||r/l<n.sellRatio||(a+=1,n.sellBtn.click(),e+=i,r-=o,a>50)););}if(n.autoBuy&&n.ratio<n.buyRatio&&null!==n.buyBtn){let t=kt(n.buyBtn.innerHTML.substr(1)),i=0;for(;!(e-t<$t()||r+o>n.storage||r/l>n.buyRatio||(n.buyBtn.click(),e-=t,r+=o,i>50)););}}}),25)}(),lt.autoStorage&&function(){if(!y("tech-containerization"))return;let e=window.evolve.global.resource.Crates.amount,t=window.evolve.global.resource.Containers.amount,i=[],n=0;for(let o in w)w[o].unlocked&&w[o].crateable&&(i.push(w[o]),e+=w[o].crateNum,t+=w[o].containerNum,n+=w[o].storePriority,w[o].wanted_crates=0,w[o].wanted_containers=0);i.sort((function(e,t){return t.storePriority-e.storePriority}));let o=[];for(let e=0;e<i.length;e++)0!=i[e].storeMin&&o.push(i[e]);let r=e,l=t;for(let e=0;e<o.length;e++){let t=Math.min(r,o[e].storeMin);o[e].wanted_crates+=t,r-=t}for(let o=0;o<i.length;o++){let a=Math.ceil(e*i[o].storePriority/n);a=Math.min(a,r),-1!=i[o].storeMax&&(a=Math.min(a,i[o].storeMax)),0!=i[o].wanted_crates?(r-=(a=Math.max(i[o].wanted_crates,a))-i[o].wanted_crates,i[o].wanted_crates=a):(i[o].wanted_crates=a,r-=a);let s=Math.ceil(t*i[o].storePriority/n);s=Math.min(s,l),-1!=i[o].storeMax&&(s=Math.min(s,i[o].storeMax)),i[o].wanted_containers=s,l-=s}for(let e=0;e<i.length;e++)i[e].wanted_crates<i[e].crateNum&&i[e].crateDec(i[e].crateNum-i[e].wanted_crates),y("tech-steel_containers")&&i[e].wanted_containers<i[e].containerNum&&i[e].containerDec(i[e].containerNum-i[e].wanted_containers);for(let e=0;e<i.length;e++)i[e].wanted_crates>i[e].crateNum&&i[e].crateInc(i[e].wanted_crates-i[e].crateNum),y("tech-steel_containers")&&i[e].wanted_containers>i[e].containerNum&&i[e].containerInc(i[e].wanted_containers-i[e].containerNum)}(),lt.autoPrestige&&function(){switch(lt.prestige){case"mad":{let e=document.getElementById("mad");if(null===e||"none"==e.style.display)return;if(dt)return;e.classList.contains("armed")?(e.querySelector(".button:not(.arm)").click(),dt=!0):e.querySelector(".button.arm").click();break}case"bioseed":if(!window.evolve.global.starDock.hasOwnProperty("seeder"))return;if(100!==window.evolve.global.starDock.seeder.count)return;if(dt)return;if(0!=$(".modal").length)return;if(modal)return;modal=!0,$("#space-star_dock > .special").click(),setTimeout((function(){let e=document.querySelector("#spcdock-prep_ship > a"),t=document.querySelector("#spcdock-launch_ship > a");e&&e.click(),t&&t.click();let i=$(".modal-close")[0];void 0!==i&&i.click(),modal=!1}),100),dt=!0;break;case"blackhole":{let e=document.querySelector("#tech-exotic_infusion > .button"),t=document.querySelector("#tech-infusion_check > .button"),i=document.querySelector("#tech-infusion_confirm > .button");e&&e.click(),t&&t.click(),i&&i.click();break}}}()}}!async function(){console.log("Waiting for game to load..."),await yt(2e3),await async function(){window.evolve=unsafeWindow.evolve,console.log(window.evolve),at(),console.log(lt);var e=1;for(;;)await yt(2e3),await It(e),e+=1}()}()}]);